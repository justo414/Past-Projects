/*! For license information please see vendors~AppHomePage~C~2d4de964.1aedc6b8.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{3043:function(e,t,r){e.exports=r(3044)},3044:function(e,t,r){"use strict";var n=r(3045),o=r(3046),i=r(3047),a=r(3065);function c(e){var t=new i(e),r=o(i.prototype.request,t);return n.extend(r,i.prototype,t),n.extend(r,t),r}var s=c(r(3052));s.Axios=i,s.create=function(e){return c(a(s.defaults,e))},s.Cancel=r(3068),s.CancelToken=r(3069),s.isCancel=r(3064),s.all=function(e){return Promise.all(e)},s.spread=r(3070),s.isAxiosError=r(3071),e.exports=s,e.exports.default=s},3045:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r(3046),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function c(e){return void 0===e}function s(e){return null!==e&&"object"===n(e)}function u(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function d(e){return"[object Function]"===i.call(e)}function l(e,t){if(null!=e)if("object"!==n(e)&&(e=[e]),a(e))for(var r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!c(e)&&null!==e.constructor&&!c(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:u,isUndefined:c,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:d,isStream:function(e){return s(e)&&d(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function e(){var t={};function r(r,n){u(t[n])&&u(r)?t[n]=e(t[n],r):u(r)?t[n]=e({},r):a(r)?t[n]=r.slice():t[n]=r}for(var n=0,o=arguments.length;n<o;n++)l(arguments[n],r);return t},extend:function(e,t,r){return l(t,(function(t,n){e[n]=r&&"function"==typeof t?o(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},3046:function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},3047:function(e,t,r){"use strict";var n=r(3045),o=r(3048),i=r(3049),a=r(3050),c=r(3065),s=r(3066),u=s.validators;function d(e){this.defaults=e,this.interceptors={request:new i,response:new i}}d.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=c(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&s.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var r=[],n=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(n=n&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var o,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!n){var d=[a,void 0];for(Array.prototype.unshift.apply(d,r),d=d.concat(i),o=Promise.resolve(e);d.length;)o=o.then(d.shift(),d.shift());return o}for(var l=e;r.length;){var h=r.shift(),p=r.shift();try{l=h(l)}catch(f){p(f);break}}try{o=a(l)}catch(f){return Promise.reject(f)}for(;i.length;)o=o.then(i.shift(),i.shift());return o},d.prototype.getUri=function(e){return e=c(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){d.prototype[e]=function(t,r){return this.request(c(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){d.prototype[e]=function(t,r,n){return this.request(c(n||{},{method:e,url:t,data:r}))}})),e.exports=d},3048:function(e,t,r){"use strict";var n=r(3045);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(n.isURLSearchParams(t))i=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))})))})),i=a.join("&")}if(i){var c=e.indexOf("#");-1!==c&&(e=e.slice(0,c)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},3049:function(e,t,r){"use strict";var n=r(3045);function o(){this.handlers=[]}o.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},3050:function(e,t,r){"use strict";var n=r(3045),o=r(3051),i=r(3064),a=r(3052);function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return c(e),e.headers=e.headers||{},e.data=o.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return c(e),t.data=o.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(c(e),t&&t.response&&(t.response.data=o.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},3051:function(e,t,r){"use strict";var n=r(3045),o=r(3052);e.exports=function(e,t,r){var i=this||o;return n.forEach(r,(function(r){e=r.call(i,e,t)})),e}},3052:function(e,t,r){"use strict";(function(t){var n=r(3045),o=r(3053),i=r(3054),a={"Content-Type":"application/x-www-form-urlencoded"};function c(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(s=r(3055)),s),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(c(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(c(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(t||JSON.parse)(e),n.trim(e)}catch(o){if("SyntaxError"!==o.name)throw o}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,r=t&&t.silentJSONParsing,o=t&&t.forcedJSONParsing,a=!r&&"json"===this.responseType;if(a||o&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(c){if(a){if("SyntaxError"===c.name)throw i(c,this,"E_JSON_PARSE");throw c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){u.headers[e]=n.merge(a)})),e.exports=u}).call(this,r(2343))},3053:function(e,t,r){"use strict";var n=r(3045);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},3054:function(e,t,r){"use strict";e.exports=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},3055:function(e,t,r){"use strict";var n=r(3045),o=r(3056),i=r(3058),a=r(3048),c=r(3059),s=r(3062),u=r(3063),d=r(3057);e.exports=function(e){return new Promise((function(t,r){var l=e.data,h=e.headers,p=e.responseType;n.isFormData(l)&&delete h["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(g+":"+m)}var y=c(e.baseURL,e.url);function v(){if(f){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,i={data:p&&"text"!==p&&"json"!==p?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};o(t,r,i),f=null}}if(f.open(e.method.toUpperCase(),a(y,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=v:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(v)},f.onabort=function(){f&&(r(d("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){r(d("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(d(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var E=(e.withCredentials||u(y))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;E&&(h[e.xsrfHeaderName]=E)}"setRequestHeader"in f&&n.forEach(h,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete h[t]:f.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),p&&"json"!==p&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),r(e),f=null)})),l||(l=null),f.send(l)}))}},3056:function(e,t,r){"use strict";var n=r(3057);e.exports=function(e,t,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},3057:function(e,t,r){"use strict";var n=r(3054);e.exports=function(e,t,r,o,i){var a=new Error(e);return n(a,t,r,o,i)}},3058:function(e,t,r){"use strict";var n=r(3045);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,o,i,a){var c=[];c.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&c.push("expires="+new Date(r).toGMTString()),n.isString(o)&&c.push("path="+o),n.isString(i)&&c.push("domain="+i),!0===a&&c.push("secure"),document.cookie=c.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},3059:function(e,t,r){"use strict";var n=r(3060),o=r(3061);e.exports=function(e,t){return e&&!n(t)?o(e,t):t}},3060:function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},3061:function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},3062:function(e,t,r){"use strict";var n=r(3045),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,a={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},3063:function(e,t,r){"use strict";var n=r(3045);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=o(window.location.href),function(t){var r=n.isString(t)?o(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},3064:function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},3065:function(e,t,r){"use strict";var n=r(3045);e.exports=function(e,t){t=t||{};var r={},o=["url","method","data"],i=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],c=["validateStatus"];function s(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function u(o){n.isUndefined(t[o])?n.isUndefined(e[o])||(r[o]=s(void 0,e[o])):r[o]=s(e[o],t[o])}n.forEach(o,(function(e){n.isUndefined(t[e])||(r[e]=s(void 0,t[e]))})),n.forEach(i,u),n.forEach(a,(function(o){n.isUndefined(t[o])?n.isUndefined(e[o])||(r[o]=s(void 0,e[o])):r[o]=s(void 0,t[o])})),n.forEach(c,(function(n){n in t?r[n]=s(e[n],t[n]):n in e&&(r[n]=s(void 0,e[n]))}));var d=o.concat(i).concat(a).concat(c),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return n.forEach(l,u),r}},3066:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r(3067),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(r){return n(r)===e||"a"+(t<1?"n ":" ")+e}}));var a={},c=o.version.split(".");function s(e,t){for(var r=t?t.split("."):c,n=e.split("."),o=0;o<3;o++){if(r[o]>n[o])return!0;if(r[o]<n[o])return!1}return!1}i.transitional=function(e,t,r){var n=t&&s(t);function i(e,t){return"[Axios v"+o.version+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,o,c){if(!1===e)throw new Error(i(o," has been removed in "+t));return n&&!a[o]&&(a[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,o,c)}},e.exports={isOlderVersion:s,assertOptions:function(e,t,r){if("object"!==n(e))throw new TypeError("options must be an object");for(var o=Object.keys(e),i=o.length;i-- >0;){var a=o[i],c=t[a];if(c){var s=e[a],u=void 0===s||c(s,a,e);if(!0!==u)throw new TypeError("option "+a+" must be "+u)}else if(!0!==r)throw Error("Unknown option "+a)}},validators:i}},3067:function(e){e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},3068:function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},3069:function(e,t,r){"use strict";var n=r(3068);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},3070:function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},3071:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"object"===n(e)&&!0===e.isAxiosError}},3222:function(e,t,r){"use strict";var n=r(3223);r.d(t,"d",(function(){return n.a}));var o=r(3253);r.d(t,"c",(function(){return o.b})),r.d(t,"b",(function(){return o.a}));r(3242),r(3227),r(3249),r(3225);var i=r(3231);r.d(t,"a",(function(){return i.a}));r(3230),r(3254),r(3229),r(3255)},3223:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r(3232),o=r(3224),i=r(3234),a=r(3235),c=r(3236),s=r(3237),u=r(3239),d=r(3242),l=r(3228),h=r(3233),p=r(3243),f=r(3238),g=r(3244),m=r(3226),y=r(3245),v=r(3246),E=r(3247),b=r(3252),C=r(3229),w=r(3231),T=r(3230),I=r(3254),S=r(3255),A=r(3256),O=r(3257),_=r(3227),R="id_token",k="token",N="id_token token",P=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=Object(b.a)(e),this.redirectCallbacksSet=!1,this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new u.a(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=m.a.urlContainsHash(t);p.a.checkIfBackButtonIsPressed(this.cacheStorage),!r||p.a.isInIframe()||p.a.isInPopup()||this.handleAuthenticationResponse(t)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=E.a.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw this.redirectCallbacksSet=!1,C.a.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectCallbacksSet=!0;var r=this.cacheStorage.getItem(_.i.URL_HASH);r&&this.processCallBack(r,null)},e.prototype.urlContainsHash=function(e){return m.a.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(e===_.c.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==_.c.interactionTypePopup)throw T.a.createInvalidInteractionTypeError();r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.cacheStorage.removeItem(_.i.INTERACTION_STATUS),e===_.c.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,r.accountState):this.authResponseCallback(t,r);else{if(e!==_.c.interactionTypePopup)throw T.a.createInvalidInteractionTypeError();n(t)}},e.prototype.loginRedirect=function(e){var t=y.a.validateRequest(e,!0,this.clientId,_.c.interactionTypeRedirect,this.redirectCallbacksSet);this.acquireTokenInteractive(_.c.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){var t=y.a.validateRequest(e,!1,this.clientId,_.c.interactionTypeRedirect,this.redirectCallbacksSet);this.acquireTokenInteractive(_.c.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this,r=y.a.validateRequest(e,!0,this.clientId,_.c.interactionTypePopup);return new Promise((function(e,n){t.acquireTokenInteractive(_.c.interactionTypePopup,!0,r,e,n)})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),e}))},e.prototype.acquireTokenPopup=function(e){var t=this,r=y.a.validateRequest(e,!1,this.clientId,_.c.interactionTypePopup);return new Promise((function(e,n){t.acquireTokenInteractive(_.c.interactionTypePopup,!1,r,e,n)})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),e}))},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i=this;p.a.blockReloadInHiddenIframes();var c=this.cacheStorage.getItem(_.i.INTERACTION_STATUS);if(e===_.c.interactionTypeRedirect&&this.cacheStorage.setItem(_.i.REDIRECT_REQUEST,""+_.c.inProgress+_.c.resourceDelimiter+r.state),c===_.c.inProgress){var s=t?T.a.createLoginInProgressError():T.a.createAcquireTokenInProgressError(),u=Object(A.a)(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,s,u,o)}var d=r&&r.account&&!t?r.account:this.getAccount();if(d||a.a.isSSOParam(r))this.acquireTokenHelper(d,e,t,r,n,o);else{if(!t){this.logger.info("User login is required");u=Object(A.a)(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,T.a.createUserLoginRequiredError(),u,o)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var l=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(l).then((function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,n)}),(function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,r,n,o)}))}else this.acquireTokenHelper(null,e,t,r,n,o)}},e.prototype.acquireTokenHelper=function(e,t,r,o,i,c){var s=this;this.cacheStorage.setItem(_.i.INTERACTION_STATUS,_.c.inProgress);var u,d,l=o.scopes?o.scopes.join(" ").toLowerCase():this.clientId.toLowerCase(),h=o&&o.authority?E.a.CreateInstance(o.authority,this.config.auth.validateAuthority):this.authorityInstance;if(t===_.c.interactionTypePopup){try{d=this.openPopup("about:blank","msal",_.c.popUpWidth,_.c.popUpHeight),p.a.trackPopup(d)}catch(f){this.logger.info(T.b.popUpWindowError.code+":"+T.b.popUpWindowError.desc),this.cacheStorage.setItem(_.d.ERROR,T.b.popUpWindowError.code),this.cacheStorage.setItem(_.d.ERROR_DESC,T.b.popUpWindowError.desc),c&&c(T.a.createPopupWindowError())}if(!d)return}h.resolveEndpointsAsync().then((function(){return n.b(s,void 0,void 0,(function(){var s,f,g,y,v;return n.d(this,(function(n){switch(n.label){case 0:if(s=r?R:this.getTokenType(e,o.scopes,!1),r&&((f=this.cacheStorage.getItem(""+_.i.ANGULAR_LOGIN_REQUEST+_.c.resourceDelimiter+o.state))&&""!==f?this.cacheStorage.setItem(""+_.i.ANGULAR_LOGIN_REQUEST+_.c.resourceDelimiter+o.state,""):f=window.location.href),u=new a.a(h,this.clientId,s,this.getRedirectUri(o&&o.redirectUri),o.scopes,o.state,o.correlationId),this.updateCacheEntries(u,e,f),u.populateQueryParams(e,o),g=m.a.createNavigateUrl(u)+_.c.response_mode_fragment,t===_.c.interactionTypeRedirect)r||this.cacheStorage.setItem(""+_.i.STATE_ACQ_TOKEN+_.c.resourceDelimiter+o.state,u.state,this.inCookie);else{if(t!==_.c.interactionTypePopup)throw T.a.createInvalidInteractionTypeError();window.renewStates.push(u.state),window.requestType=r?_.c.login:_.c.renewToken,this.registerCallback(u.state,l,i,c)}if(this.navigateWindow(g,d),!d)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,p.a.monitorWindowForHash(d,this.config.system.loadFrameTimeout,g)];case 2:return y=n.sent(),this.handleAuthenticationResponse(y),this.cacheStorage.removeItem(_.i.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",y),p.a.closePopups()),[3,4];case 3:return v=n.sent(),c&&c(v),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",v.errorCode+_.c.resourceDelimiter+v.errorMessage):(this.cacheStorage.removeItem(_.i.INTERACTION_STATUS),d.close()),[3,4];case 4:return[2]}}))}))})).catch((function(e){s.logger.warning("could not resolve endpoints"),s.cacheStorage.resetTempCacheItems(o.state),s.authErrorHandler(t,T.a.createEndpointResolutionError(e.toString),Object(A.a)(o.state),c),d&&d.close()}))},e.prototype.acquireTokenSilent=function(e){var t=this,r=y.a.validateRequest(e,!1,this.clientId);return new Promise((function(e,n){p.a.blockReloadInHiddenIframes();var o=r.scopes.join(" ").toLowerCase(),i=r.account||t.getAccount(),c=t.cacheStorage.getItem(_.c.adalIdToken);if(!i&&!r.sid&&!r.loginHint&&h.a.isEmpty(c))return t.logger.info("User login is required"),n(T.a.createUserLoginRequiredError());var s=t.getTokenType(i,r.scopes,!0),u=new a.a(E.a.CreateInstance(r.authority,t.config.auth.validateAuthority),t.clientId,s,t.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId);if(a.a.isSSOParam(r)||i)u.populateQueryParams(i,r);else if(!i&&!h.a.isEmpty(c)){var d=f.a.extractIdToken(c);t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),u.populateQueryParams(i,null,d)}var l,g,m=r.claimsRequest||u.claimsValue;if(!m&&!r.forceRefresh)try{g=t.getCachedToken(u,i)}catch(v){l=v}if(g)return t.logger.info("Token is already in cache for scope:"+o),e(g),null;if(l)return t.logger.infoPii(l.errorCode+":"+l.errorMessage),n(l),null;var y=void 0;return y=m?"Skipped cache lookup since claims were given.":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope:"+o,t.logger.verbose(y),u.authorityInstance||(u.authorityInstance=r.authority?E.a.CreateInstance(r.authority,t.config.auth.validateAuthority):t.authorityInstance),u.authorityInstance.resolveEndpointsAsync().then((function(){window.activeRenewals[o]?(t.logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&r.scopes.indexOf(t.clientId)>-1&&1===r.scopes.length?(t.logger.verbose("renewing idToken"),t.silentLogin=!0,t.renewIdToken(r.scopes,e,n,i,u)):(t.logger.verbose("renewing accesstoken"),t.renewToken(r.scopes,e,n,i,u))})).catch((function(e){return t.logger.warning("could not resolve endpoints"),n(T.a.createEndpointResolutionError(e.toString())),null}))})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),e}))},e.prototype.openPopup=function(e,t,r,n){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=a/2-r/2+o,u=c/2-n/2+i,d=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+s);if(!d)throw T.a.createPopupWindowError();return d.focus&&d.focus(),d}catch(l){throw this.logger.error("error opening popup "+l.message),this.cacheStorage.removeItem(_.i.INTERACTION_STATUS),T.a.createPopupWindowError(l.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return n.b(this,void 0,void 0,(function(){var o,i,a,c;return n.d(this,(function(n){switch(n.label){case 0:return o=window.activeRenewals[r],this.logger.verbose("Set loading state to pending for: "+r+":"+o),this.cacheStorage.setItem(""+_.i.RENEW_STATUS+_.c.resourceDelimiter+o,_.c.inProgress),[4,p.a.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)];case 1:i=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,p.a.monitorWindowForHash(i.contentWindow,this.config.system.loadFrameTimeout,e)];case 3:return(a=n.sent())&&this.handleAuthenticationResponse(a),[3,5];case 4:throw c=n.sent(),this.cacheStorage.getItem(""+_.i.RENEW_STATUS+_.c.resourceDelimiter+o)===_.c.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope "+r+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,c),this.cacheStorage.removeItem(""+_.i.RENEW_STATUS+_.c.resourceDelimiter+o)),p.a.removeHiddenIframe(i),c;case 5:return p.a.removeHiddenIframe(i),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||h.a.isEmpty(e))throw this.logger.info("Navigate url is empty"),w.a.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),w.a.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(a){o.logger.warning(a)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(){var e=this;this.clearCache(),this.account=null;var t="";this.getPostLogoutRedirectUri()&&(t="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri())),this.authorityInstance.resolveEndpointsAsync().then((function(r){var n=r.EndSessionEndpoint?r.EndSessionEndpoint+"?"+t:e.authority+"oauth2/v2.0/logout?"+t;e.navigateWindow(n)}))},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(_.c.clientId,_.c.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(_.c.clientId,_.c.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),m.a.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(a){o=a}this.cacheStorage.removeItem(_.i.URL_HASH);try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(n){if(t.requestType===_.c.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),n.tokenType=_.h.ACCESS_TOKEN):t.requestType===_.c.login&&(n.tokenType=_.h.ID_TOKEN),!r)return void this.authResponseHandler(_.c.interactionTypeRedirect,n)}else if(!r)return this.cacheStorage.resetTempCacheItems(t.state),void this.authErrorHandler(_.c.interactionTypeRedirect,o,Object(A.a)(i));r(n,o)}catch(a){throw this.logger.error("Error occurred in token received callback function: "+a),T.a.createErrorInCallbackFunction(a.toString())}},e.prototype.handleAuthenticationResponse=function(e){var t=e||window.location.hash,r=p.a.getIframeWithHash(t),n=p.a.getPopUpWithHash(t),o=!(!r&&!n),i=this.getResponseState(t),a=null;if(this.logger.info("Returned from redirect url"),o)a=window.callbackMappedToRenewStates[i.state];else{if(a=null,this.config.auth.navigateToLoginRequestUrl){if(this.cacheStorage.setItem(_.i.URL_HASH,t),window.parent===window){var c=this.cacheStorage.getItem(""+_.i.LOGIN_REQUEST+_.c.resourceDelimiter+i.state,this.inCookie);c&&"null"!==c?window.location.href=c:(this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),window.location.href="/")}return}if(window.location.hash="",!this.redirectCallbacksSet)return void this.cacheStorage.setItem(_.i.URL_HASH,t)}this.processCallBack(t,i,a),o&&p.a.closePopups()},e.prototype.getResponseState=function(e){var t,r=m.a.deserializeHash(e);if(!r)throw w.a.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty("state"))throw w.a.createUnexpectedError("Hash does not contain state.");if((t={requestType:_.c.unknown,state:r.state,stateMatch:!1}).state===this.cacheStorage.getItem(""+_.i.STATE_LOGIN+_.c.resourceDelimiter+t.state,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=_.c.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(""+_.i.STATE_ACQ_TOKEN+_.c.resourceDelimiter+t.state,this.inCookie))return t.requestType=_.c.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var n=window.renewStates,o=0;o<n.length;o++)if(n[o]===t.state){t.stateMatch=!0;break}}return t},e.prototype.getCachedToken=function(e,t){var r=null,n=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++){u=(c=o[a]).key.scopes.split(" ");l.a.containsScope(u,n)&&m.a.CanonicalizeUri(c.key.authority)===e.authority&&i.push(c)}if(0===i.length)return null;if(1!==i.length)throw T.a.createMultipleMatchingTokensInCacheError(n.toString());r=i[0]}else{for(var a=0;a<o.length;a++){var c,u=(c=o[a]).key.scopes.split(" ");l.a.containsScope(u,n)&&i.push(c)}if(1===i.length)r=i[0],e.authorityInstance=E.a.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(i.length>1)throw T.a.createMultipleMatchingTokensInCacheError(n.toString());var d=this.getUniqueAuthority(o,"authority");if(d.length>1)throw T.a.createMultipleAuthoritiesInCacheError(n.toString());e.authorityInstance=E.a.CreateInstance(d[0],this.config.auth.validateAuthority)}}if(null!=r){var h=Number(r.value.expiresIn),p=this.config.system.tokenRenewalOffsetSeconds||300;if(h&&h>g.a.now()+p){var f=new s.a(r.value.idToken);if(!t&&!(t=this.getAccount()))throw w.a.createUnexpectedError("Account should not be null here.");var y=this.getAccountState(e.state),b={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?_.h.ID_TOKEN:_.h.ACCESS_TOKEN,idToken:f,idTokenClaims:f.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*h),account:t,accountState:y,fromCache:!0};return v.a.setResponseIdToken(b,f),b}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null}return null},e.prototype.getUniqueAuthority=function(e,t){var r=[],n=[];return e.forEach((function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))})),r},e.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(_.c.adalIdToken);return h.a.isEmpty(e)?null:f.a.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){var i=e.join(" ").toLowerCase();this.logger.verbose("renewToken is called for scope:"+i);var a="msalRenewFrame"+i,c=p.a.addHiddenIFrame(a,this.logger);this.updateCacheEntries(o,n),this.logger.verbose("Renew token Expected state: "+o.state);var s=m.a.urlRemoveQueryStringParameter(m.a.createNavigateUrl(o),_.c.prompt)+_.c.prompt_none+_.c.response_mode_fragment;window.renewStates.push(o.state),window.requestType=_.c.renewToken,this.registerCallback(o.state,i,t,r),this.logger.infoPii("Navigate to:"+s),c.src="about:blank",this.loadIframeTimeout(s,a,i).catch((function(e){return r(e)}))},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("renewidToken is called");var i=p.a.addHiddenIFrame("msalIdTokenFrame",this.logger);this.updateCacheEntries(o,n),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var a=m.a.urlRemoveQueryStringParameter(m.a.createNavigateUrl(o),_.c.prompt)+_.c.prompt_none+_.c.response_mode_fragment;this.silentLogin?(window.requestType=_.c.login,this.silentAuthenticationState=o.state):(window.requestType=_.c.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,r),this.logger.infoPii("Navigate to:"+a),i.src="about:blank",this.loadIframeTimeout(a,"msalIdTokenFrame",this.clientId).catch((function(e){return r(e)}))},e.prototype.saveAccessToken=function(e,t,r,a,s){var u,d,h=n.a({},e),p=new c.a(a);if(r.hasOwnProperty(_.h.SCOPE)){for(var f=(u=r[_.h.SCOPE]).split(" "),m=this.cacheStorage.getAllAccessTokens(this.clientId,t),y=0;y<m.length;y++){var v=m[y];if(v.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var E=v.key.scopes.split(" ");l.a.isIntersectingScopes(E,f)&&this.cacheStorage.removeItem(JSON.stringify(v.key))}}var b=g.a.parseExpiresIn(r[_.h.EXPIRES_IN]);d=g.a.now()+b;var C=new o.a(t,this.clientId,u,p.uid,p.utid),w=new i.a(r[_.h.ACCESS_TOKEN],s.rawIdToken,d.toString(),a);this.cacheStorage.setItem(JSON.stringify(C),JSON.stringify(w)),h.accessToken=r[_.h.ACCESS_TOKEN],h.scopes=f}else{u=this.clientId;C=new o.a(t,this.clientId,u,p.uid,p.utid);d=Number(s.expiration);w=new i.a(r[_.h.ID_TOKEN],r[_.h.ID_TOKEN],d.toString(),a);this.cacheStorage.setItem(JSON.stringify(C),JSON.stringify(w)),h.scopes=[u],h.accessToken=r[_.h.ID_TOKEN]}return d?h.expiresOn=new Date(1e3*d):this.logger.error("Could not parse expiresIn parameter"),h},e.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=m.a.deserializeHash(e),i="",a="",l=null;if(o.hasOwnProperty(_.h.ERROR_DESCRIPTION)||o.hasOwnProperty(_.h.ERROR)){if(this.logger.infoPii("Error :"+o[_.h.ERROR]+"; Error description:"+o[_.h.ERROR_DESCRIPTION]),this.cacheStorage.setItem(_.d.ERROR,o[_.h.ERROR]),this.cacheStorage.setItem(_.d.ERROR_DESC,o[_.h.ERROR_DESCRIPTION]),t.requestType===_.c.login&&(this.cacheStorage.setItem(_.d.LOGIN_ERROR,o[_.h.ERROR_DESCRIPTION]+":"+o[_.h.ERROR]),i=u.a.generateAuthorityKey(t.state)),t.requestType===_.c.renewToken){i=u.a.generateAuthorityKey(t.state);var p=this.getAccount(),f=void 0;f=p&&!h.a.isEmpty(p.homeAccountIdentifier)?p.homeAccountIdentifier:_.c.no_account,a=u.a.generateAcquireTokenAccountKey(f,t.state)}var g=o[_.h.ERROR],y=o[_.h.ERROR_DESCRIPTION];r=S.a.isInteractionRequiredError(g)||S.a.isInteractionRequiredError(y)?new S.a(o[_.h.ERROR],o[_.h.ERROR_DESCRIPTION]):new I.a(o[_.h.ERROR],o[_.h.ERROR_DESCRIPTION])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(_.h.SESSION_STATE)&&this.cacheStorage.setItem(""+_.i.SESSION_STATE+_.c.resourceDelimiter+t.state,o[_.h.SESSION_STATE]),n.accountState=this.getAccountState(t.state);var E="";if(o.hasOwnProperty(_.h.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),o.hasOwnProperty(_.h.ID_TOKEN)?(l=new s.a(o[_.h.ID_TOKEN]),n.idToken=l,n.idTokenClaims=l.claims):(l=new s.a(this.cacheStorage.getItem(_.e.IDTOKEN)),n=v.a.setResponseIdToken(n,l));var b=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,l);if(!o.hasOwnProperty(_.h.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),T.a.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");E=o[_.h.CLIENT_INFO],n.account=d.a.createAccount(l,new c.a(E));var C=void 0;C=n.account&&!h.a.isEmpty(n.account.homeAccountIdentifier)?n.account.homeAccountIdentifier:_.c.no_account,a=u.a.generateAcquireTokenAccountKey(C,t.state);var A=u.a.generateAcquireTokenAccountKey(_.c.no_account,t.state),O=this.cacheStorage.getItem(a),R=void 0;h.a.isEmpty(O)?h.a.isEmpty(this.cacheStorage.getItem(A))||(n=this.saveAccessToken(n,b,o,E,l)):(R=JSON.parse(O),n.account&&R&&d.a.compareAccounts(n.account,R)?(n=this.saveAccessToken(n,b,o,E,l),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(_.h.ID_TOKEN)){this.logger.info("Fragment has id token"),l=new s.a(o[_.h.ID_TOKEN]),n=v.a.setResponseIdToken(n,l),o.hasOwnProperty(_.h.CLIENT_INFO)?E=o[_.h.CLIENT_INFO]:this.logger.warning("ClientInfo not received in the response from AAD");b=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,l);this.account=d.a.createAccount(l,new c.a(E)),n.account=this.account,l&&l.nonce?l.nonce!==this.cacheStorage.getItem(""+_.i.NONCE_IDTOKEN+_.c.resourceDelimiter+t.state,this.inCookie)?(this.account=null,this.cacheStorage.setItem(_.d.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(""+_.i.NONCE_IDTOKEN+_.c.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+l.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(""+_.i.NONCE_IDTOKEN+_.c.resourceDelimiter+t.state,this.inCookie)+",Actual Nonce: "+l.nonce),r=T.a.createNonceMismatchError(this.cacheStorage.getItem(""+_.i.NONCE_IDTOKEN+_.c.resourceDelimiter+t.state,this.inCookie),l.nonce)):(this.cacheStorage.setItem(_.e.IDTOKEN,o[_.h.ID_TOKEN]),this.cacheStorage.setItem(_.e.CLIENT_INFO,E),this.saveAccessToken(n,b,o,E,l)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=T.a.createInvalidIdTokenError(l),this.cacheStorage.setItem(_.d.ERROR,r.errorCode),this.cacheStorage.setItem(_.d.ERROR_DESC,r.errorMessage))}}else{i=t.state,a=t.state;var k=this.cacheStorage.getItem(""+_.i.STATE_LOGIN+_.c.resourceDelimiter+t.state,this.inCookie);this.logger.error("State Mismatch.Expected State: "+k+",Actual State: "+t.state),r=T.a.createInvalidStateError(t.state,k),this.cacheStorage.setItem(_.d.ERROR,r.errorCode),this.cacheStorage.setItem(_.d.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(""+_.i.RENEW_STATUS+_.c.resourceDelimiter+t.state),this.cacheStorage.resetTempCacheItems(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw w.a.createUnexpectedError("Response is null");return n},e.prototype.populateAuthority=function(e,t,r,n){var o=u.a.generateAuthorityKey(e),i=r.getItem(o,t);return h.a.isEmpty(i)?i:m.a.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(_.e.IDTOKEN),t=this.cacheStorage.getItem(_.e.CLIENT_INFO);if(!h.a.isEmpty(e)&&!h.a.isEmpty(t)){var r=new s.a(e),n=new c.a(t);return this.account=d.a.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(_.c.clientId,_.c.homeAccountIdentifier),r=0;r<t.length;r++){var n=new s.a(t[r].value.idToken),o=new c.a(t[r].value.homeAccountIdentifier),i=d.a.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:E.a.CreateInstance(this.authority,this.config.auth.validateAuthority),c=this.getTokenType(o,e,!0),s=new a.a(i,this.clientId,c,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?m.a.getHostFromUri(e)===m.a.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return!!this.cacheStorage.getItem(_.i.URL_HASH)||this.cacheStorage.getItem(_.i.INTERACTION_STATUS)===_.c.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(_.i.INTERACTION_STATUS,_.c.inProgress):this.cacheStorage.removeItem(_.i.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(_.i.INTERACTION_STATUS)===_.c.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.config.system.logger},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw C.a.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t,r){return r?d.a.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?R:k:t.indexOf(this.config.auth.clientId)>-1?R:N:d.a.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?R:k:N},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):_.c.no_account,n=u.a.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=u.a.generateAuthorityKey(e);this.cacheStorage.setItem(r,m.a.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r){r?(this.cacheStorage.setItem(""+_.i.LOGIN_REQUEST+_.c.resourceDelimiter+e.state,r,this.inCookie),this.cacheStorage.setItem(""+_.i.STATE_LOGIN+_.c.resourceDelimiter+e.state,e.state,this.inCookie)):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(""+_.i.NONCE_IDTOKEN+_.c.resourceDelimiter+e.state,e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return h.a.isEmpty(e.homeAccountIdentifier)?_.c.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return null;var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw C.a.createTelemetryConfigError(e);var i={platform:{sdk:"msal.js",sdkVersion:Object(_.j)(),applicationName:r,applicationVersion:n},clientId:t};return new O.a(i,o)},e}()},3224:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3225),o=r(3226),i=function(e,t,r,i,a){this.authority=o.a.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=n.a.base64Encode(i)+"."+n.a.base64Encode(a)}},3225:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",c=0;c<36;c++)"-"!==n[c]&&"4"!==n[c]&&(i=16*Math.random()|0),"x"===n[c]?a+=o[i]:"y"===n[c]?(i&=3,a+=o[i|=8]):a+=n[c];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}()},3226:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3227),o=r(3228),i=r(3233),a=r(3225),c=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(o.a.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),o=r.PathSegments;return!t||0===o.length||o[0]!==n.c.common&&o[0]!==n.g.ORGANIZATIONS||(o[0]=t),this.constructAuthorityUriFromObject(r,o)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(i.a.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(n.h.ERROR_DESCRIPTION)||r.hasOwnProperty(n.h.ERROR)||r.hasOwnProperty(n.h.ACCESS_TOKEN)||r.hasOwnProperty(n.h.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return a.a.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}()},3227:function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"h",(function(){return n})),r.d(t,"i",(function(){return o})),r.d(t,"e",(function(){return i})),r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return u})),r.d(t,"g",(function(){return s})),r.d(t,"b",(function(){return d})),r.d(t,"f",(function(){return l})),r.d(t,"j",(function(){return h}));var n,o,i,a,c=function(){function e(){}return Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(n||(n={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.ANGULAR_LOGIN_REQUEST="angular.login.request",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(o||(o={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(i||(i={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(a||(a={}));var s,u={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier",e.LOGIN_REQ="login_req",e.DOMAIN_REQ="domain_req"}(s||(s={}));var d=[s.SID,s.LOGIN_HINT],l={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};function h(){return"1.2.1"}},3228:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3229),o=function(){function e(){}return e.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var r=0;r<t.length;r++)if(e.indexOf(t[r].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every((function(t){return e.indexOf(t.toString().toLowerCase())>=0}))},e.convertToLowerCase=function(e){return e.map((function(e){return e.toLowerCase()}))},e.removeElement=function(e,t){return e.filter((function(e){return e!==t}))},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t,r){if(e){if(!Array.isArray(e))throw n.a.createScopesNonArrayError(e);if(e.length<1)throw n.a.createEmptyScopesArrayError(e.toString());if(e.indexOf(r)>-1&&e.length>1)throw n.a.createClientIdSingleScopeError(e.toString())}else if(t)throw n.a.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){return e?t?e.concat(t):e:null},e}()},3229:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r(3232),o=r(3230),i={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"}},a=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return n.c(t,e),t.createNoSetConfigurationError=function(){return new t(i.configurationNotSet.code,""+i.configurationNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(i.storageNotSupported.code,i.storageNotSupported.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(i.noRedirectCallbacksSet.code,i.noRedirectCallbacksSet.desc)},t.createInvalidCallbackObjectError=function(e){return new t(i.invalidCallbackObject.code,i.invalidCallbackObject.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(i.emptyScopes.code,i.emptyScopes.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(i.nonArrayScopes.code,i.nonArrayScopes.desc+" Given value: "+e+".")},t.createClientIdSingleScopeError=function(e){return new t(i.clientScope.code,i.clientScope.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(i.scopesRequired.code,i.scopesRequired.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(i.invalidPrompt.code,i.invalidPrompt.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(i.claimsRequestParsingError.code,i.claimsRequestParsingError.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=i.emptyRequestError;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(i.invalidCorrelationIdError.code,i.invalidCorrelationIdError.desc)},t.createTelemetryConfigError=function(e){var r=i.telemetryConfigError,n=r.code,o=r.desc,a={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(a).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+a[r]+")"])}),[]).join(","))},t}(o.a)},3230:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c}));var n=r(3232),o=r(3231),i=r(3233),a={multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required."},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},blockTokenRequestsInHiddenIframe:{code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"}},c=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return n.c(t,e),t.createEndpointResolutionError=function(e){var r=a.endpointResolutionError.desc;return e&&!i.a.isEmpty(e)&&(r+=" Details: "+e),new t(a.endpointResolutionError.code,r)},t.createMultipleMatchingTokensInCacheError=function(e){return new t(a.multipleMatchingTokens.code,"Cache error for scope "+e+": "+a.multipleMatchingTokens.desc+".")},t.createMultipleAuthoritiesInCacheError=function(e){return new t(a.multipleCacheAuthorities.code,"Cache error for scope "+e+": "+a.multipleCacheAuthorities.desc+".")},t.createPopupWindowError=function(e){var r=a.popUpWindowError.desc;return e&&!i.a.isEmpty(e)&&(r+=" Details: "+e),new t(a.popUpWindowError.code,r)},t.createTokenRenewalTimeoutError=function(e){var r="URL navigated to is "+e+", "+a.tokenRenewalError.desc;return new t(a.tokenRenewalError.code,r)},t.createInvalidIdTokenError=function(e){return new t(a.invalidIdToken.code,a.invalidIdToken.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(a.invalidStateError.code,a.invalidStateError.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(a.nonceMismatchError.code,a.nonceMismatchError.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(a.loginProgressError.code,a.loginProgressError.desc)},t.createAcquireTokenInProgressError=function(){return new t(a.acquireTokenProgressError.code,a.acquireTokenProgressError.desc)},t.createUserCancelledError=function(){return new t(a.userCancelledError.code,a.userCancelledError.desc)},t.createErrorInCallbackFunction=function(e){return new t(a.callbackError.code,a.callbackError.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(a.userLoginRequiredError.code,a.userLoginRequiredError.desc)},t.createUserDoesNotExistError=function(){return new t(a.userDoesNotExistError.code,a.userDoesNotExistError.desc)},t.createClientInfoDecodingError=function(e){return new t(a.clientInfoDecodingError.code,a.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(a.clientInfoNotPopulatedError.code,a.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(a.nullOrEmptyIdToken.code,a.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(a.idTokenNotParsed.code,a.idTokenNotParsed.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(a.tokenEncodingError.code,a.tokenEncodingError.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(a.invalidInteractionType.code,a.invalidInteractionType.desc)},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+a.cacheParseError.desc;return new t(a.cacheParseError.code,r)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(a.blockTokenRequestsInHiddenIframe.code,a.blockTokenRequestsInHiddenIframe.desc)},t}(o.a)},3231:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3232),o={code:"unexpected_error",desc:"Unexpected error in authentication."},i={code:"no_window_object",desc:"No window object available. Details:"},a=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return n.c(t,e),t.createUnexpectedError=function(e){return new t(o.code,o.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(i.code,i.desc+" "+e)},t}(Error)},3232:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return s}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(t){i(t)}}function c(e){try{s(n.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function s(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}},3233:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}()},3234:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}},3235:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3225),o=r(3227),i=r(3233),a=function(){function e(e,t,r,i,a,c,s){this.authorityInstance=e,this.clientId=t,this.nonce=n.a.createNewGuid(),this.scopes=a?a.slice():[t],this.state=c,this.correlationId=s,this.xClientSku="MSAL.JS",this.xClientVer=Object(o.j)(),this.responseType=r,this.redirectUri=i}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n){var o={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(o=this.constructUnifiedCacheQueryParameter(r,null))),n&&(o=this.constructUnifiedCacheQueryParameter(null,n)),o=this.addHintParameters(t,o);var i=r.extraQueryParameters;this.queryParameters=e.generateQueryParametersString(o),this.extraQueryParameters=e.generateQueryParametersString(i)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,i={};if(e)if(e.account){var a=e.account;a.sid?(r=o.g.SID,n=a.sid):a.userName&&(r=o.g.LOGIN_HINT,n=a.userName)}else e.sid?(r=o.g.SID,n=e.sid):e.loginHint&&(r=o.g.LOGIN_HINT,n=e.loginHint);else t&&(t.hasOwnProperty(o.c.upn)?(r=o.g.ID_TOKEN,n=t.upn):(r=o.g.ORGANIZATIONS,n=null));return i=this.addSSOParameter(r,n),e&&e.account&&e.account.homeAccountIdentifier&&(i=this.addSSOParameter(o.g.HOMEACCOUNT_ID,e.account.homeAccountIdentifier,i)),i},e.prototype.addHintParameters=function(e,t){if(e&&!t[o.g.SID]){if(!t[o.g.LOGIN_HINT]&&e.sid&&this.promptValue===o.f.NONE)t=this.addSSOParameter(o.g.SID,e.sid,t);else!t[o.g.LOGIN_HINT]&&e.userName&&!i.a.isEmpty(e.userName)&&(t=this.addSSOParameter(o.g.LOGIN_HINT,e.userName,t));!t[o.g.DOMAIN_REQ]&&!t[o.g.LOGIN_REQ]&&(t=this.addSSOParameter(o.g.HOMEACCOUNT_ID,e.homeAccountIdentifier,t))}return t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case o.g.SID:r[o.g.SID]=t;break;case o.g.ID_TOKEN:r[o.g.LOGIN_HINT]=t,r[o.g.DOMAIN_HINT]=o.g.ORGANIZATIONS;break;case o.g.LOGIN_HINT:r[o.g.LOGIN_HINT]=t;break;case o.g.ORGANIZATIONS:r[o.g.DOMAIN_HINT]=o.g.ORGANIZATIONS;break;case o.g.CONSUMERS:r[o.g.DOMAIN_HINT]=o.g.CONSUMERS;break;case o.g.HOMEACCOUNT_ID:var i=t.split("."),a=n.a.base64Decode(i[0]),c=n.a.base64Decode(i[1]);r[o.g.LOGIN_REQ]=a,r[o.g.DOMAIN_REQ]=c,c===o.c.consumersUtid?r[o.g.DOMAIN_HINT]=o.g.CONSUMERS:r[o.g.DOMAIN_HINT]=o.g.ORGANIZATIONS;break;case o.g.LOGIN_REQ:r[o.g.LOGIN_REQ]=t;break;case o.g.DOMAIN_REQ:r[o.g.DOMAIN_REQ]=t}return r},e.generateQueryParametersString=function(e){var t=null;return e&&Object.keys(e).forEach((function(r){null==t?t=r+"="+encodeURIComponent(e[r]):t+="&"+r+"="+encodeURIComponent(e[r])})),t},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e}()},3236:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3225),o=r(3230),i=r(3233),a=function(){function e(e){if(!e||i.a.isEmpty(e))return this.uid="",void(this.utid="");try{var t=n.a.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(a){throw o.a.createClientInfoDecodingError(a)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}()},3237:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3230),o=r(3238),i=r(3233),a=function(e){if(i.a.isEmpty(e))throw n.a.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=o.a.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw n.a.createIdTokenParsingError(t)}}},3238:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3225),o=r(3233),i=function(){function e(){}return e.decodeJwt=function(e){if(o.a.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=n.a.base64Decode(r);return o?JSON.parse(o):null}catch(i){}return null},e}()},3239:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3232),o=r(3227),i=r(3240),a=r(3241),c=r(3230),s=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return n.c(t,e),t.prototype.migrateCacheEntries=function(t){var r=this,n=o.c.cachePrefix+"."+o.e.IDTOKEN,i=o.c.cachePrefix+"."+o.e.CLIENT_INFO,a=o.c.cachePrefix+"."+o.d.ERROR,c=o.c.cachePrefix+"."+o.d.ERROR_DESC,s=[e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,c)];[o.e.IDTOKEN,o.e.CLIENT_INFO,o.d.ERROR,o.d.ERROR_DESC].forEach((function(e,n){return r.duplicateCacheEntry(e,s[n],t)}))},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+o.c.cachePrefix)||0===e.indexOf(o.c.adalIdToken)?e:t?o.c.cachePrefix+"."+this.clientId+"."+e:o.c.cachePrefix+"."+e}},t.prototype.setItem=function(t,r,n,o){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(o.c.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(e){var t,r=window[this.cacheLocation];for(t in r)if(!e||-1!==t.indexOf(e)){var n=t.split(o.c.resourceDelimiter),i=n.length>1?n[n.length-1]:null;i!==e||this.tokenRenewalInProgress(i)||(this.removeItem(t),this.setItemCookie(t,"",-1),this.clearMsalCookie(e))}this.removeItem(o.i.INTERACTION_STATUS),this.removeItem(o.i.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce((function(n,a){if(a.match(e)&&a.match(t)&&a.match(o.c.scopes)){var s=r.getItem(a);if(s)try{var u=JSON.parse(a),d=new i.a(u,JSON.parse(s));return n.concat([d])}catch(l){throw c.a.createCacheParseError(a)}}return n}),[])},t.prototype.tokenRenewalInProgress=function(e){var t=this.getItem(o.i.RENEW_STATUS+"|"+e);return!(!t||t!==o.c.inProgress)},t.prototype.clearMsalCookie=function(e){this.clearItemCookie(o.i.NONCE_IDTOKEN+"|"+e),this.clearItemCookie(o.i.STATE_LOGIN+"|"+e),this.clearItemCookie(o.i.LOGIN_REQUEST+"|"+e),this.clearItemCookie(o.i.STATE_ACQ_TOKEN+"|"+e)},t.generateAcquireTokenAccountKey=function(e,t){return""+o.i.ACQUIRE_TOKEN_ACCOUNT+o.c.resourceDelimiter+e+o.c.resourceDelimiter+t},t.generateAuthorityKey=function(e){return""+o.i.AUTHORITY+o.c.resourceDelimiter+e},t}(a.a)},3240:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e,t){this.key=e,this.value=t}},3241:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3229),o=r(3231),i=function(){function e(e){if(!window)throw o.a.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!=window[e]))throw n.a.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}()},3242:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3225),o=r(3233),i=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var i,a=t.objectId||t.subject,c=r?r.uid:"",s=r?r.utid:"";return o.a.isEmpty(c)||o.a.isEmpty(s)||(i=n.a.base64Encode(c)+"."+n.a.base64Encode(s)),new e(a,i,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}()},3243:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3230),o=r(3226),i=r(3227),a=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.monitorWindowForHash=function(t,r,i){return new Promise((function(a,c){var s=r/e.POLLING_INTERVAL_MS,u=0,d=setInterval((function(){if(t.closed)return clearInterval(d),void c(n.a.createUserCancelledError());var e;try{e=t.location.href}catch(r){}e&&"about:blank"!==e&&(u++,o.a.urlContainsHash(e)?(clearInterval(d),a(t.location.hash)):u>s&&(clearInterval(d),c(n.a.createTokenRenewalTimeoutError(i))))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(t,r,n,o){return o.info("LoadFrame: "+r),new Promise((function(i,a){setTimeout((function(){var n=e.addHiddenIFrame(r,o);n?(""!==n.src&&"about:blank"!==n.src||(n.src=t,o.infoPii("Frame Name : "+r+" Navigated to: "+t)),i(n)):a("Unable to load iframe with name: "+r)}),n)}))},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.info("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},e.removeHiddenIframe=function(e){document.body!==e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(r){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(r){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(o.a.urlContainsHash(window.location.hash)&&e.isInIframe())throw n.a.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(i.i.REDIRECT_REQUEST);if(t&&!o.a.urlContainsHash(window.location.hash)){var r=t.split(i.c.resourceDelimiter),n=r.length>1?r[r.length-1]:null;e.resetTempCacheItems(n)}},e.POLLING_INTERVAL_MS=50,e}()},3244:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e}()},3245:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3232),o=r(3227),i=r(3229),a=r(3228),c=r(3233),s=r(3225),u=function(){function e(){}return e.validateRequest=function(e,t,r,c,s){if(!t&&!e)throw i.a.createEmptyRequestError();if(c==o.c.interactionTypeRedirect&&!s)throw i.a.createRedirectCallbacksNotSetError();var u,d;e&&(u=t?a.a.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,a.a.validateInputScope(u,!t,r),this.validatePromptParameter(e.prompt),d=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var l=this.validateAndGenerateState(e&&e.state),h=this.validateAndGenerateCorrelationId(e&&e.correlationId);return n.a({},e,{extraQueryParameters:d,scopes:u,state:l,correlationId:h})},e.validatePromptParameter=function(e){if(e&&[o.f.LOGIN,o.f.SELECT_ACCOUNT,o.f.CONSENT,o.f.NONE].indexOf(e)<0)throw i.a.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=n.a({},e);return r?(t&&delete r[o.c.claims],o.b.forEach((function(e){r[e]&&delete r[e]})),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(t){throw i.a.createClaimsRequestParsingError(t)}},e.validateAndGenerateState=function(e){return c.a.isEmpty(e)?s.a.createNewGuid():s.a.createNewGuid()+"|"+e},e.validateAndGenerateCorrelationId=function(e){if(e&&!s.a.isGuid(e))throw i.a.createInvalidCorrelationIdError();return s.a.isGuid(e)?e:s.a.createNewGuid()},e}()},3246:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3232),o=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),n.a({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}()},3247:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3248),o=r(3251),i=r(3249),a=r(3229),c=r(3226),s=r(3233),u=function(){function e(){}return e.DetectAuthorityFromUrl=function(e){switch(e=c.a.CanonicalizeUri(e),c.a.GetUrlComponents(e).PathSegments[0]){case"tfp":return i.b.B2C;default:return i.b.Aad}},e.CreateInstance=function(t,r){if(s.a.isEmpty(t))return null;switch(e.DetectAuthorityFromUrl(t)){case i.b.B2C:return new o.a(t,r);case i.b.Aad:return new n.a(t,r);default:throw a.b.invalidAuthorityType}},e}()},3248:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3232),o=r(3249),i=r(3250),a=r(3227),c=function(e){function t(t,r){return e.call(this,t,r)||this}return n.c(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return o.b.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){return n.b(this,void 0,void 0,(function(){return n.d(this,(function(e){return!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?[2,this.DefaultOpenIdConfigurationEndpoint]:[2,(new i.a).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then((function(e){return e.tenant_discovery_endpoint}))]}))}))},t.prototype.IsInTrustedHostList=function(e){return a.a[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t}(o.a)},3249:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return s}));var n,o=r(3232),i=r(3229),a=r(3250),c=r(3226);!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(n||(n={}));var s=function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=c.a.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=c.a.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(t){throw i.b.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw i.b.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw i.b.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e){return(new a.a).sendRequestAsync(e,"GET",!0).then((function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}}))},e.prototype.resolveEndpointsAsync=function(){return o.b(this,void 0,void 0,(function(){var e,t;return o.d(this,(function(r){switch(r.label){case 0:return[4,this.GetOpenIdConfigurationEndpointAsync()];case 1:return e=r.sent(),t=this,[4,this.DiscoverEndpoints(e)];case 2:return t.tenantDiscoveryResponse=r.sent(),[2,this]}}))}))},e}()},3250:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{t=JSON.parse(i.responseText)}catch(a){o(n.handleError(i.responseText))}r(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(r){return e}},e}()},3251:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3232),o=r(3248),i=r(3249),a=r(3229),c=r(3226),s=function(e){function t(t,r){var n=e.call(this,t,r)||this,o=c.a.GetUrlComponents(t),i=o.PathSegments;if(i.length<3)throw a.b.b2cAuthorityUriInvalidPath;return n.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",n}return n.c(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return i.b.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){return n.b(this,void 0,void 0,(function(){return n.d(this,(function(e){if(!this.IsValidationEnabled||this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort))return[2,this.DefaultOpenIdConfigurationEndpoint];throw a.b.unsupportedAuthorityValidation}))}))},t.B2C_PREFIX="tfp",t}(o.a)},3252:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(3232),o=r(3253),i=r(3226),a={clientId:"",authority:null,validateAuthority:!0,redirectUri:function(){return i.a.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return i.a.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},c={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},s={logger:new o.b(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},u={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};function d(e){var t=e.auth,r=e.cache,o=void 0===r?{}:r,i=e.system,d=void 0===i?{}:i,l=e.framework,h=void 0===l?{}:l;return{auth:n.a({},a,t),cache:n.a({},c,o),system:n.a({},s,d),framework:n.a({},u,h)}}},3253:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n,o=r(3233),i=r(3227);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(n||(n={}));var a=function(){function e(e,t){void 0===t&&(t={}),this.level=n.Info;var r=t.correlationId,o=void 0===r?"":r,i=t.level,a=void 0===i?n.Info:i,c=t.piiLoggingEnabled,s=void 0!==c&&c;this.localCallback=e,this.correlationId=o,this.level=a,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var a,c=(new Date).toUTCString();a=o.a.isEmpty(this.correlationId)?c+":"+Object(i.j)()+"-"+n[e]+" "+t:c+":"+this.correlationId+"-"+Object(i.j)()+"-"+n[e]+" "+t,this.executeCallback(e,a,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(n.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(n.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(n.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(n.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(n.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(n.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(n.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(n.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}()},3254:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3232),o=r(3231),i={code:"server_unavailable",desc:"Server is temporarily unavailable."},a={code:"unknown_server_error"},c=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return n.c(t,e),t.createServerUnavailableError=function(){return new t(i.code,i.desc)},t.createUnknownServerError=function(e){return new t(a.code,e)},t}(o.a)},3255:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r(3232),o=r(3254),i={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}},a=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return n.c(t,e),t.isInteractionRequiredError=function(e){var t=[i.interactionRequired.code,i.consentRequired.code,i.loginRequired.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(i.loginRequired.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(i.interactionRequired.code,e)},t.createConsentRequiredAuthError=function(e){return new t(i.consentRequired.code,e)},t}(o.a)},3256:function(e,t,r){"use strict";function n(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}r.d(t,"a",(function(){return n}))},3257:function(e,t,r){"use strict";var n=r(3258),o=function(e){return e.telemetryCorrelationId+"-"+e.eventId+"-"+e.eventName},i=function(){function e(e,t){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=e.platform,this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t}return e.prototype.startEvent=function(e){if(this.telemetryEmitter){var t=o(e);this.inProgressEvents[t]=e}},e.prototype.stopEvent=function(e){var t=o(e);if(this.telemetryEmitter&&this.inProgressEvents[t]){e.stop(),this.incrementEventCount(e);var r=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(r||[]).concat([e]),delete this.inProgressEvents[t]}},e.prototype.flush=function(e){var t=this;if(this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var o=this.completedEvents[e].concat(r);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],o&&o.length){var a=new n.a(this.telemetryPlatform,e,this.clientId,i),c=o.concat([a]);this.telemetryEmitter(c.map((function(e){return e.get()})))}}},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r}),[])},e}();t.a=i},3258:function(e,t,r){"use strict";var n=r(3232),o=r(3259),i=r(3260),a=r(3261),c=function(e){function t(t,r,n,i){var c=e.call(this,Object(a.a)("default_event"),r)||this;return c.event[Object(a.a)("client_id")]=n,c.event[Object(a.a)("sdk_plaform")]=t.sdk,c.event[Object(a.a)("sdk_version")]=t.sdkVersion,c.event[Object(a.a)("application_name")]=t.applicationName,c.event[Object(a.a)("application_version")]=t.applicationVersion,c.event[""+o.e.UiEventCountTelemetryBatchKey]=c.getEventCount(Object(a.a)("ui_event"),i),c.event[""+o.e.HttpEventCountTelemetryBatchKey]=c.getEventCount(Object(a.a)("http_event"),i),c.event[""+o.e.CacheEventCountConstStrKey]=c.getEventCount(Object(a.a)("cache_event"),i),c}return n.c(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(i.a);t.a=c},3259:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return s}));var n="msal.",o="event_name",i="start_time",a="elapsed_time",c={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},s="<tenant>"},3260:function(e,t,r){"use strict";var n=r(3232),o=r(3259),i=r(3261),a=r(3225),c=function(){function e(e,t){var r;this.startTimestamp=Date.now(),this.eventId=a.a.createNewGuid(),this.event=((r={})[Object(i.a)(o.b)]=e,r[Object(i.a)(o.d)]=this.startTimestamp,r[Object(i.a)(o.a)]=-1,r[""+o.e.MsalCorrelationIdConstStrKey]=t,r)}return e.prototype.setElapsedTime=function(e){this.event[Object(i.a)(o.a)]=e},e.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+o.e.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+o.e.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[Object(i.a)(o.b)]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return n.a({},this.event,{eventId:this.eventId})},e}();t.a=c},3261:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r(3251),r(3227);var n=r(3259),o=(r(3225),r(3226),function(e){return""+n.c+(e||"")})},3263:function(e,t,r){"use strict";e.exports=function(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}},3277:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return a}));var n=r(3278),o=r(3279),i=r(3282),a={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."}},c=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return Object(n.c)(t,e),t.createPkceNotGeneratedError=function(e){return new t(a.pkceNotGenerated.code,a.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(a.cryptoDoesNotExist.code,a.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(a.httpMethodNotImplementedError.code,a.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(a.emptyNavigateUriError.code,a.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t(a.hashEmptyError.code,a.hashEmptyError.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(a.hashDoesNotContainStateError.code,a.hashDoesNotContainStateError.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(a.hashDoesNotContainKnownPropertiesError.code,a.hashDoesNotContainKnownPropertiesError.desc)},t.createUnableToParseStateError=function(){return new t(a.unableToParseStateError.code,a.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(a.stateInteractionTypeMismatchError.code,a.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t(a.interactionInProgress.code,a.interactionInProgress.desc)},t.createPopupWindowError=function(e){var r=a.popupWindowError.desc;return r=o.a.isEmpty(e)?r:r+" Details: "+e,new t(a.popupWindowError.code,r)},t.createEmptyWindowCreatedError=function(){return new t(a.emptyWindowError.code,a.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t(a.userCancelledError.code,a.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t(a.monitorPopupTimeoutError.code,a.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t(a.monitorIframeTimeoutError.code,a.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t(a.redirectInIframeError.code,a.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(a.blockTokenRequestsInHiddenIframeError.code,a.blockTokenRequestsInHiddenIframeError.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(a.blockAcquireTokenInPopupsError.code,a.blockAcquireTokenInPopupsError.desc)},t.createIframeClosedPrematurelyError=function(){return new t(a.iframeClosedPrematurelyError.code,a.iframeClosedPrematurelyError.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(a.silentLogoutUnsupportedError.code,a.silentLogoutUnsupportedError.desc)},t.createNoAccountError=function(){return new t(a.noAccountError.code,a.noAccountError.desc)},t.createSilentPromptValueError=function(e){return new t(a.silentPromptValueError.code,a.silentPromptValueError.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(a.unableToParseTokenRequestCacheError.code,a.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t(a.noTokenRequestCacheError.code,a.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t(a.authRequestNotSet.code,a.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t(a.noCachedAuthorityError.code,a.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t(a.invalidCacheType.code,""+a.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t(a.notInBrowserEnvironment.code,a.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t(a.databaseNotOpen.code,a.databaseNotOpen.desc)},t.createNoNetworkConnectivityError=function(){return new t(a.noNetworkConnectivity.code,a.noNetworkConnectivity.desc)},t.createPostRequestFailedError=function(e,r){return new t(a.postRequestFailed.code,a.postRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(a.getRequestFailed.code,a.getRequestFailed.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(a.failedToParseNetworkResponse.code,a.failedToParseNetworkResponse.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(a.unableToLoadTokenError.code,a.unableToLoadTokenError.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(a.signingKeyNotFoundInStorage.code,a.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(a.authCodeRequired.code,a.authCodeRequired.desc)},t.createDatabaseUnavailableError=function(){return new t(a.databaseUnavailable.code,a.databaseUnavailable.desc)},t}(i.a)},3278:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return u}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(t){i(t)}}function c(e){try{s(n.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}},3279:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3280),o=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw n.a.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw n.a.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(n){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(t){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}()},3280:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(3281),o=r(3282),i={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."}},a=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return Object(n.c)(t,e),t.createClientInfoDecodingError=function(e){return new t(i.clientInfoDecodingError.code,i.clientInfoDecodingError.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(i.clientInfoEmptyError.code,""+i.clientInfoEmptyError.desc)},t.createTokenParsingError=function(e){return new t(i.tokenParsingError.code,i.tokenParsingError.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(i.nullOrEmptyToken.code,i.nullOrEmptyToken.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(i.endpointResolutionError.code,i.endpointResolutionError.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(i.networkError.code,i.networkError.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(i.unableToGetOpenidConfigError.code,i.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(i.hashNotDeserialized.code,i.hashNotDeserialized.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(i.invalidStateError.code,i.invalidStateError.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(i.stateMismatchError.code,i.stateMismatchError.desc)},t.createStateNotFoundError=function(e){return new t(i.stateNotFoundError.code,i.stateNotFoundError.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(i.nonceMismatchError.code,i.nonceMismatchError.desc)},t.createNonceNotFoundError=function(e){return new t(i.nonceNotFoundError.code,i.nonceNotFoundError.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(i.multipleMatchingTokens.code,i.multipleMatchingTokens.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(i.multipleMatchingAccounts.code,i.multipleMatchingAccounts.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(i.multipleMatchingAppMetadata.code,i.multipleMatchingAppMetadata.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(i.tokenRequestCannotBeMade.code,i.tokenRequestCannotBeMade.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(i.appendEmptyScopeError.code,i.appendEmptyScopeError.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(i.removeEmptyScopeError.code,i.removeEmptyScopeError.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(i.appendScopeSetError.code,i.appendScopeSetError.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(i.emptyInputScopeSetError.code,""+i.emptyInputScopeSetError.desc)},t.createDeviceCodeCancelledError=function(){return new t(i.DeviceCodePollingCancelled.code,""+i.DeviceCodePollingCancelled.desc)},t.createDeviceCodeExpiredError=function(){return new t(i.DeviceCodeExpired.code,""+i.DeviceCodeExpired.desc)},t.createDeviceCodeUnknownError=function(){return new t(i.DeviceCodeUnknownError.code,""+i.DeviceCodeUnknownError.desc)},t.createNoAccountInSilentRequestError=function(){return new t(i.NoAccountInSilentRequest.code,""+i.NoAccountInSilentRequest.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(i.invalidCacheRecord.code,i.invalidCacheRecord.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(i.invalidCacheEnvironment.code,i.invalidCacheEnvironment.desc)},t.createNoAccountFoundError=function(){return new t(i.noAccountFound.code,i.noAccountFound.desc)},t.createCachePluginError=function(){return new t(i.CachePluginError.code,""+i.CachePluginError.desc)},t.createNoCryptoObjectError=function(e){return new t(i.noCryptoObj.code,""+i.noCryptoObj.desc+e)},t.createInvalidCacheTypeError=function(){return new t(i.invalidCacheType.code,""+i.invalidCacheType.desc)},t.createUnexpectedAccountTypeError=function(){return new t(i.unexpectedAccountType.code,""+i.unexpectedAccountType.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(i.unexpectedCredentialType.code,""+i.unexpectedCredentialType.desc)},t.createInvalidAssertionError=function(){return new t(i.invalidAssertion.code,""+i.invalidAssertion.desc)},t.createInvalidCredentialError=function(){return new t(i.invalidClientCredential.code,""+i.invalidClientCredential.desc)},t.createRefreshRequiredError=function(){return new t(i.tokenRefreshRequired.code,i.tokenRefreshRequired.desc)},t.createUserTimeoutReachedError=function(){return new t(i.userTimeoutReached.code,i.userTimeoutReached.desc)},t.createTokenClaimsRequiredError=function(){return new t(i.tokenClaimsRequired.code,i.tokenClaimsRequired.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(i.noAuthorizationCodeFromServer.code,i.noAuthorizationCodeFromServer.desc)},t.createBindingKeyNotRemovedError=function(){return new t(i.bindingKeyNotRemovedError.code,i.bindingKeyNotRemovedError.desc)},t.createLogoutNotSupportedError=function(){return new t(i.logoutNotSupported.code,i.logoutNotSupported.desc)},t}(o.a)},3281:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return s}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{s(n.next(e))}catch(t){i(t)}}function c(e){try{s(n.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(c){i=[6,c],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}function s(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n}},3282:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3281),o=r(3283),i={code:"unexpected_error",desc:"Unexpected error in authentication."},a=function(e){function t(r,n,i){var a=this,c=n?r+": "+n:r;return a=e.call(this,c)||this,Object.setPrototypeOf(a,t.prototype),a.errorCode=r||o.n.EMPTY_STRING,a.errorMessage=n||"",a.subError=i||"",a.name="AuthError",a}return Object(n.c)(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(i.code,i.desc+": "+e)},t}(Error)},3283:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return T})),r.d(t,"d",(function(){return A})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return I})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return U})),r.d(t,"j",(function(){return E})),r.d(t,"k",(function(){return b})),r.d(t,"l",(function(){return c})),r.d(t,"m",(function(){return C})),r.d(t,"n",(function(){return u})),r.d(t,"o",(function(){return v})),r.d(t,"p",(function(){return D})),r.d(t,"q",(function(){return g})),r.d(t,"r",(function(){return n})),r.d(t,"s",(function(){return d})),r.d(t,"t",(function(){return l})),r.d(t,"u",(function(){return R})),r.d(t,"v",(function(){return o})),r.d(t,"w",(function(){return p})),r.d(t,"x",(function(){return P})),r.d(t,"y",(function(){return N})),r.d(t,"z",(function(){return k})),r.d(t,"A",(function(){return f})),r.d(t,"B",(function(){return _})),r.d(t,"C",(function(){return h})),r.d(t,"D",(function(){return y})),r.d(t,"E",(function(){return S})),r.d(t,"F",(function(){return j}));var n,o,i,a,c,s=r(3281),u={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},d=[u.OPENID_SCOPE,u.PROFILE_SCOPE,u.OFFLINE_ACCESS_SCOPE],l=Object(s.e)(d,[u.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info"}(n||(n={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account"}(o||(o={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(i||(i={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code"}(a||(a={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(c||(c={}));var h,p={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(h||(h={}));var f,g,m,y,v,E,b,C={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(f||(f={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(g||(g={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(m||(m={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(y||(y={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(v||(v={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(E||(E={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(b||(b={}));var w,T="appmetadata",I="client_info",S="1",A={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400};!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(w||(w={}));var O,_={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(O||(O={}));var R,k,N,P,U,j={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},D={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"};!function(e){e.username="username",e.password="password"}(R||(R={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(k||(k={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(N||(N={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(P||(P={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(U||(U={}))},3284:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));var n=r(3281),o=r(3282),i=["interaction_required","consent_required","login_required"],a=["message_only","additional_action","basic_action","user_password_expired","consent_required"],c={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."}},s=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return Object(n.c)(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&i.indexOf(e)>-1,o=!!r&&a.indexOf(r)>-1,c=!!t&&i.some((function(e){return t.indexOf(e)>-1}));return n||c||o},t.createNoTokensFoundError=function(){return new t(c.noTokensFoundError.code,c.noTokensFoundError.desc)},t}(o.a)},3285:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3278),o=r(3286),i=r(3338),a=r(3288),c=r(3277),s=r(3287),u=function(e){function t(t){var r=e.call(this,t)||this;return r.activeSilentTokenRequests=new Map,r}return Object(n.c)(t,e),t.prototype.loginRedirect=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(e||o.g)]}))}))},t.prototype.loginPopup=function(e){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(e||o.g)},t.prototype.acquireTokenSilent=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,i,a,s,u=this;return Object(n.d)(this,(function(n){if(this.preflightBrowserEnvironmentCheck(o.j.Silent),this.logger.verbose("acquireTokenSilent called",e.correlationId),!(t=e.account||this.getActiveAccount()))throw c.a.createNoAccountError();return r={clientId:this.config.auth.clientId,authority:e.authority||"",scopes:e.scopes,homeAccountIdentifier:t.homeAccountId,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshJwk:e.sshJwk,sshKid:e.sshKid},i=JSON.stringify(r),void 0===(a=this.activeSilentTokenRequests.get(i))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",e.correlationId),s=this.acquireTokenSilentAsync(e,t).then((function(e){return u.activeSilentTokenRequests.delete(i),e})).catch((function(e){throw u.activeSilentTokenRequests.delete(i),e})),this.activeSilentTokenRequests.set(i,s),[2,s]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",e.correlationId),[2,a])}))}))},t.prototype.acquireTokenSilentAsync=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,i,c=this;return Object(n.d)(this,(function(u){return r=new s.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId),i=r.initializeSilentRequest(e,t),this.eventHandler.emitEvent(a.a.ACQUIRE_TOKEN_START,o.j.Silent,e),[2,r.acquireToken(i).catch((function(){return Object(n.b)(c,void 0,void 0,(function(){var e,t;return Object(n.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireTokenByRefreshToken(i)];case 1:return e=r.sent(),this.eventHandler.emitEvent(a.a.ACQUIRE_TOKEN_SUCCESS,o.j.Silent,e),[2,e];case 2:throw t=r.sent(),this.eventHandler.emitEvent(a.a.ACQUIRE_TOKEN_FAILURE,o.j.Silent,null,t),t;case 3:return[2]}}))}))}))]}))}))},t}(i.a)},3286:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return a})),r.d(t,"j",(function(){return s})),r.d(t,"k",(function(){return f})),r.d(t,"l",(function(){return i}));var n,o,i,a,c,s,u,d=r(3283),l={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",POLL_INTERVAL_MS:50,MSAL_SKU:"msal.js.browser"};!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(n||(n={})),function(e){e.GET="GET",e.POST="POST"}(o||(o={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId"}(i||(i={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(a||(a={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(c||(c={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}(s||(s={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(u||(u={}));var h,p={scopes:d.s},f="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(h||(h={}));var g="msal.db",m=1,y=g+".keys"},3287:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3278),o=r(3321),i=r(3289),a=r(3288),c=r(3286),s=r(3277),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o,i;return Object(n.d)(this,(function(n){switch(n.label){case 0:return t=this.initializeServerTelemetryManager(c.a.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(t,e.authority)];case 1:r=n.sent(),this.logger.verbose("Silent auth client created"),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,r.acquireCachedToken(e)];case 3:return o=n.sent(),this.eventHandler.emitEvent(a.a.ACQUIRE_TOKEN_SUCCESS,c.j.Silent,o),[2,o];case 4:throw(i=n.sent())instanceof s.a&&i.errorCode===s.b.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(s.a.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new i.a(r)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return Object(n.a)(Object(n.a)(Object(n.a)({},e),this.initializeBaseRequest(e)),{account:t,forceRefresh:e.forceRefresh||!1})},t}(o.a)},3288:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(n||(n={}))},3289:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(3281),o=r(3313),i=r(3302),a=r(3295),c=r(3291),s=r(3290),u=r(3280),d=r(3303),l=r(3292),h=r(3283),p=r(3279),f=function(e){function t(t){return e.call(this,t)||this}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof u.a&&t.errorCode===u.b.tokenRefreshRequired.code)return[2,new s.a(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,o,a;return Object(n.b)(this,void 0,void 0,(function(){var s,l,f,g;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(!e)throw d.a.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(h.i.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),u.a.createRefreshRequiredError();if(!p.a.isEmptyObj(e.claims))throw this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims are requested."),u.a.createRefreshRequiredError();if(!e.account)throw u.a.createNoAccountInSilentRequestError();if(s=new i.a(e.scopes||[]),l=e.authority||this.authority.getPreferredCache(),f=e.authenticationScheme||h.e.BEARER,!(g=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,s,l,f,e.sshKid)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(h.i.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),u.a.createRefreshRequiredError();if(c.a.wasClockTurnedBack(g.accessToken.cachedAt)||c.a.isTokenExpired(g.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(h.i.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),u.a.createRefreshRequiredError();if(g.accessToken.refreshOn&&c.a.isTokenExpired(g.accessToken.refreshOn,0))throw null===(a=this.serverTelemetryManager)||void 0===a||a.setCacheOutcome(h.i.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),u.a.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(g,e)];case 1:return[2,n.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return e.idToken&&(r=new a.a(e.idToken.secret,this.config.cryptoInterface)),[4,l.a.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,n.sent()]}}))}))},t}(o.a)},3290:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(3281),o=r(3313),i=r(3311),a=r(3283),c=r(3292),s=r(3308),u=r(3279),d=r(3303),l=r(3280),h=r(3293),p=r(3291),f=r(3309),g=r(3310),m=r(3294),y=r(3284),v=function(e){function t(t){return e.call(this,t)||this}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:return t=p.a.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=n.sent(),(o=new c.a(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,o.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(n){if(!e)throw d.a.createEmptyTokenRequestError();if(!e.account)throw l.a.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(o){if(t=o instanceof y.a&&o.errorCode===y.b.noTokensFoundError.code,r=o instanceof h.a&&o.errorCode===a.p.INVALID_GRANT_ERROR&&o.subError===a.p.CLIENT_MISMATCH_ERROR,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw o}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,o;return Object(n.d)(this,(function(i){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw y.a.createNoTokensFoundError();return o=Object(n.a)(Object(n.a)({},e),{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||a.e.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:g.a.HOME_ACCOUNT_ID}}),[2,this.acquireToken(o)]}))}))},t.prototype.executeTokenRequest=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,o,i,a,c;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=n.sent(),o=this.createTokenQueryParameters(e),i=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshJwk:e.sshJwk,sshKid:e.sshKid},c=f.a.appendQueryString(t.tokenEndpoint,o),[2,this.executePostToTokenEndpoint(c,r,i,a)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new i.a;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o,c,l;return Object(n.d)(this,(function(n){switch(n.label){case 0:return(t=new i.a).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(a.q.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(o=this.config.clientCredentials.clientAssertion,t.addClientAssertion(o.assertion),t.addClientAssertionType(o.assertionType)),e.authenticationScheme!==a.e.POP?[3,2]:[4,new s.a(this.cryptoUtils).generateCnf(e)];case 1:return c=n.sent(),t.addPopToken(c),[3,3];case 2:if(e.authenticationScheme===a.e.SSH){if(!e.sshJwk)throw d.a.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}n.label=3;case 3:if((!u.a.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case g.a.HOME_ACCOUNT_ID:try{l=Object(m.b)(e.ccsCredential.credential),t.addCcsOid(l)}catch(h){this.logger.verbose("Could not parse home account ID for CCS Header: "+h)}break;case g.a.UPN:t.addCcsUpn(e.ccsCredential.credential)}return[2,t.createQueryString()]}}))}))},t}(o.a)},3291:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}()},3292:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(3281),o=r(3294),i=r(3280),a=r(3279),c=r(3293),s=r(3295),u=r(3302),d=r(3296),l=r(3297),h=r(3300),p=r(3304),f=r(3305),g=r(3284),m=r(3307),y=r(3298),v=r(3283),E=r(3308),b=r(3306),C=r(3299),w=function(){function e(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?i.a.createStateNotFoundError("Cached State"):i.a.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw i.a.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(g.a.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new g.a(e.error||v.n.EMPTY_STRING,e.error_description,e.suberror);throw new c.a(e.error||v.n.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Object(o.a)(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(g.a.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new g.a(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new c.a(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,o,c,u,l,h){return Object(n.b)(this,void 0,void 0,(function(){var p,f,g,m,E;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(t.id_token&&(p=new s.a(t.id_token||v.n.EMPTY_STRING,this.cryptoObj),u&&!a.a.isEmpty(u.nonce)&&p.claims.nonce!==u.nonce))throw i.a.createNonceMismatchError();this.homeAccountIdentifier=d.a.generateHomeAccountId(t.client_info||v.n.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,p),u&&u.state&&(f=y.a.parseRequestState(this.cryptoObj,u.state)),t.key_id=t.key_id||c.sshKid||void 0,g=this.generateCacheRecord(t,r,o,p,c.scopes,l,u),n.label=1;case 1:return n.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new C.a(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(m)]):[3,3];case 2:n.sent(),n.label=3;case 3:return!h||!g.account||(E=g.account.generateAccountKey(),this.cacheStorage.getAccount(E))?[4,this.cacheStorage.saveCacheRecord(g)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,g,!1,c,p,f)]);case 4:return n.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&m?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(m)]):[3,7];case 6:n.sent(),n.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,g,!1,c,p,f,t.spa_code)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,c,s){var d,l,g=t.getPreferredCache();if(a.a.isEmpty(g))throw i.a.createInvalidCacheEnvironmentError();!a.a.isEmpty(e.id_token)&&n&&(d=h.a.createIdTokenEntity(this.homeAccountIdentifier,g,e.id_token||v.n.EMPTY_STRING,this.clientId,n.claims.tid||v.n.EMPTY_STRING,c),l=this.generateAccountEntity(e,n,t,c,s));var y=null;if(!a.a.isEmpty(e.access_token)){var E=e.scope?u.a.fromString(e.scope):new u.a(o||[]),C=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,w=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,T=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,I=r+C,S=I+w,A=T&&T>0?r+T:void 0;y=p.a.createAccessTokenEntity(this.homeAccountIdentifier,g,e.access_token||v.n.EMPTY_STRING,this.clientId,n?n.claims.tid||v.n.EMPTY_STRING:t.tenant,E.printScopes(),I,S,this.cryptoObj,A,e.token_type,c,e.key_id)}var O=null;a.a.isEmpty(e.refresh_token)||(O=f.a.createRefreshTokenEntity(this.homeAccountIdentifier,g,e.refresh_token||v.n.EMPTY_STRING,this.clientId,e.foci,c));var _=null;return a.a.isEmpty(e.foci)||(_=b.a.createAppMetadataEntity(this.clientId,g,e.foci)),new m.a(l,d,y,O,_)},e.prototype.generateAccountEntity=function(e,t,r,n,o){var c=r.authorityType,s=o?o.cloud_graph_host_name:"",u=o?o.msgraph_host:"";if(c===l.a.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),d.a.createGenericAccount(this.homeAccountIdentifier,t,r,n,s,u);if(a.a.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw i.a.createClientInfoEmptyError();return e.client_info?d.a.createAccount(e.client_info,this.homeAccountIdentifier,t,r,n,s,u):d.a.createGenericAccount(this.homeAccountIdentifier,t,r,n,s,u)},e.generateAuthenticationResult=function(e,t,r,o,i,a,c,s){var d,l,h;return Object(n.b)(this,void 0,void 0,(function(){var p,f,g,m,y,b,C;return Object(n.d)(this,(function(n){switch(n.label){case 0:return p="",f=[],g=null,y=v.n.EMPTY_STRING,r.accessToken?r.accessToken.tokenType!==v.e.POP?[3,2]:[4,new E.a(e).signPopToken(r.accessToken.secret,i)]:[3,4];case 1:return p=n.sent(),[3,3];case 2:p=r.accessToken.secret,n.label=3;case 3:f=u.a.fromString(r.accessToken.target).asArray(),g=new Date(1e3*Number(r.accessToken.expiresOn)),m=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),n.label=4;case 4:return r.appMetadata&&(y=r.appMetadata.familyId===v.E?v.E:v.n.EMPTY_STRING),b=(null==a?void 0:a.claims.oid)||(null==a?void 0:a.claims.sub)||v.n.EMPTY_STRING,C=(null==a?void 0:a.claims.tid)||v.n.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:b,tenantId:C,scopes:f,account:r.account?r.account.getAccountInfo():null,idToken:a?a.rawToken:v.n.EMPTY_STRING,idTokenClaims:a?a.claims:{},accessToken:p,fromCache:o,expiresOn:g,correlationId:i.correlationId,extExpiresOn:m,familyId:y,tokenType:(null===(d=r.accessToken)||void 0===d?void 0:d.tokenType)||v.n.EMPTY_STRING,state:c?c.userRequestState:v.n.EMPTY_STRING,cloudGraphHostName:(null===(l=r.account)||void 0===l?void 0:l.cloudGraphHostName)||v.n.EMPTY_STRING,msGraphHost:(null===(h=r.account)||void 0===h?void 0:h.msGraphHost)||v.n.EMPTY_STRING,code:s}]}}))}))},e}()},3293:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3281),o=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return Object(n.c)(t,e),t}(r(3282).a)},3294:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c}));var n=r(3280),o=r(3279),i=r(3283);function a(e,t){if(o.a.isEmpty(e))throw n.a.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(i){throw n.a.createClientInfoDecodingError(i)}}function c(e){if(o.a.isEmpty(e))throw n.a.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(i.D.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?i.n.EMPTY_STRING:t[1]}}},3295:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3280),o=r(3279),i=function(){function e(t,r){if(o.a.isEmpty(t))throw n.a.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=o.a.decodeAuthToken(e);try{var i=r.JWSPayload,a=t.base64Decode(i);return JSON.parse(a)}catch(c){throw n.a.createTokenParsingError(c)}},e}()},3296:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3283),o=r(3294),i=r(3279),a=r(3280),c=r(3297),s=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(n.D.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case n.h.ADFS_ACCOUNT_TYPE:return n.k.ADFS;case n.h.MSAV1_ACCOUNT_TYPE:return n.k.MSA;case n.h.MSSTS_ACCOUNT_TYPE:return n.k.MSSTS;case n.h.GENERIC_ACCOUNT_TYPE:return n.k.GENERIC;default:throw a.a.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(n.D.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,o,i,c,s,u,d){var l,h,p,f,g,m,y=new e;y.authorityType=n.h.MSSTS_ACCOUNT_TYPE,y.clientInfo=t,y.homeAccountId=r;var v=d||i&&i.getPreferredCache();if(!v)throw a.a.createInvalidCacheEnvironmentError();return y.environment=v,y.realm=(null===(l=null==o?void 0:o.claims)||void 0===l?void 0:l.tid)||"",y.oboAssertion=c,o&&(y.idTokenClaims=o.claims,y.localAccountId=(null===(h=null==o?void 0:o.claims)||void 0===h?void 0:h.oid)||(null===(p=null==o?void 0:o.claims)||void 0===p?void 0:p.sub)||"",y.username=(null===(f=null==o?void 0:o.claims)||void 0===f?void 0:f.preferred_username)||((null===(g=null==o?void 0:o.claims)||void 0===g?void 0:g.emails)?o.claims.emails[0]:""),y.name=null===(m=null==o?void 0:o.claims)||void 0===m?void 0:m.name),y.cloudGraphHostName=s,y.msGraphHost=u,y},e.createGenericAccount=function(t,r,o,i,s,u,d){var l,h,p,f,g=new e;g.authorityType=o&&o.authorityType===c.a.Adfs?n.h.ADFS_ACCOUNT_TYPE:n.h.GENERIC_ACCOUNT_TYPE,g.homeAccountId=t,g.realm="",g.oboAssertion=i;var m=d||o&&o.getPreferredCache();if(!m)throw a.a.createInvalidCacheEnvironmentError();return r&&(g.localAccountId=(null===(l=null==r?void 0:r.claims)||void 0===l?void 0:l.oid)||(null===(h=null==r?void 0:r.claims)||void 0===h?void 0:h.sub)||"",g.username=(null===(p=null==r?void 0:r.claims)||void 0===p?void 0:p.upn)||"",g.name=(null===(f=null==r?void 0:r.claims)||void 0===f?void 0:f.name)||"",g.idTokenClaims=null==r?void 0:r.claims),g.environment=m,g.cloudGraphHostName=s,g.msGraphHost=u,g},e.generateHomeAccountId=function(e,t,r,a,s){var u,d=(null===(u=null==s?void 0:s.claims)||void 0===u?void 0:u.sub)?s.claims.sub:n.n.EMPTY_STRING;if(t===c.a.Adfs)return d;if(e)try{var l=Object(o.a)(e,a);if(!i.a.isEmpty(l.uid)&&!i.a.isEmpty(l.utid))return""+l.uid+n.D.CLIENT_INFO_SEPARATOR+l.utid}catch(h){}return r.verbose("No client info in response"),d},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&n},e}()},3297:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(n||(n={}))},3298:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3279),o=r(3283),i=r(3280),a=function(){function e(){}return e.setRequestState=function(t,r,i){var a=e.generateLibraryState(t,i);return n.a.isEmpty(r)?a:""+a+o.n.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw i.a.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw i.a.createNoCryptoObjectError("parseRequestState");if(n.a.isEmpty(t))throw i.a.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(o.n.RESOURCE_DELIM),a=r[0],c=r.length>1?r.slice(1).join(o.n.RESOURCE_DELIM):"",s=e.base64Decode(a),u=JSON.parse(s);return{userRequestState:n.a.isEmpty(c)?"":c,libraryState:u}}catch(d){throw i.a.createInvalidStateError(t,d)}},e}()},3299:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}()},3300:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3281),o=r(3301),i=r(3283),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.createIdTokenEntity=function(e,r,n,o,a,c){var s=new t;return s.credentialType=i.o.ID_TOKEN,s.homeAccountId=e,s.environment=r,s.clientId=o,s.secret=n,s.realm=a,s.oboAssertion=c,s},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===i.o.ID_TOKEN)},t}(o.a)},3301:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3283),o=r(3280),i=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType)},e.prototype.generateType=function(){switch(this.credentialType){case n.o.ID_TOKEN:return n.k.ID_TOKEN;case n.o.ACCESS_TOKEN:case n.o.ACCESS_TOKEN_WITH_AUTH_SCHEME:return n.k.ACCESS_TOKEN;case n.o.REFRESH_TOKEN:return n.k.REFRESH_TOKEN;default:throw o.a.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(n.o.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(n.o.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?n.o.ACCESS_TOKEN_WITH_AUTH_SCHEME:n.o.ACCESS_TOKEN:-1!==e.indexOf(n.o.ID_TOKEN.toLowerCase())?n.o.ID_TOKEN:-1!==e.indexOf(n.o.REFRESH_TOKEN.toLowerCase())?n.o.REFRESH_TOKEN:n.n.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,r,o,i,a,c,s){var u=[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,o,i,c),this.generateTargetForCacheKey(a)];return s&&s!==n.e.BEARER&&u.push(s.toLowerCase()),u.join(n.D.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(n.D.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,o){return[e,e===n.o.REFRESH_TOKEN&&o||t,r||""].join(n.D.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}()},3302:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3281),o=r(3303),i=r(3279),a=r(3280),c=r(3283),s=function(){function e(e){var t=this,r=e?i.a.trimArrayEntries(Object(n.e)(e)):[],o=r?i.a.removeEmptyStringsFromArray(r):[];this.validateInputScopes(o),this.scopes=new Set,o.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw o.a.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!i.a.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return c.t.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){i.a.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(r){throw a.a.createAppendScopeSetError(r)}},e.prototype.removeScope=function(e){if(i.a.isEmpty(e))throw a.a.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;c.t.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw a.a.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw a.a.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}()},3303:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var n=r(3281),o=r(3280),i={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},a={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},c={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},s={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},u={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},d={code:"empty_url_error",desc:"URL was empty or null."},l={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},h={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},p={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},f={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},g={code:"token_request_empty",desc:"Token request was empty and not found in cache."},m={code:"logout_request_empty",desc:"The logout request was null or undefined."},y={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},v={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},E={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},b={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},C={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},w={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},T={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},I={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},S={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},A=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return Object(n.c)(t,e),t.createRedirectUriEmptyError=function(){return new t(i.code,i.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(a.code,a.desc)},t.createClaimsRequestParsingError=function(e){return new t(c.code,c.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(s.code,s.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(u.code,u.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(d.code,d.desc)},t.createEmptyScopesArrayError=function(){return new t(l.code,""+l.desc)},t.createClientIdSingleScopeError=function(e){return new t(h.code,h.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(p.code,p.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(f.code,f.desc)},t.createEmptyLogoutRequestError=function(){return new t(m.code,m.desc)},t.createEmptyTokenRequestError=function(){return new t(g.code,g.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(y.code,y.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(v.code,v.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(E.code,E.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(b.code,b.desc)},t.createUntrustedAuthorityError=function(){return new t(C.code,C.desc)},t.createMissingSshJwkError=function(){return new t(w.code,w.desc)},t.createMissingSshKidError=function(){return new t(T.code,T.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(I.code,I.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(S.code,S.desc+". Invalid header: "+e+". Details: "+r)},t}(o.a)},3304:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(3281),o=r(3301),i=r(3283),a=r(3291),c=r(3279),s=r(3295),u=r(3280),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.createAccessTokenEntity=function(e,r,n,o,d,l,h,p,f,g,m,y,v){var E,b=new t;b.homeAccountId=e,b.credentialType=i.o.ACCESS_TOKEN,b.secret=n;var C=a.a.nowSeconds();if(b.cachedAt=C.toString(),b.expiresOn=h.toString(),b.extendedExpiresOn=p.toString(),g&&(b.refreshOn=g.toString()),b.environment=r,b.clientId=o,b.realm=d,b.target=l,b.oboAssertion=y,b.tokenType=c.a.isEmpty(m)?i.e.BEARER:m,b.tokenType!==i.e.BEARER)switch(b.credentialType=i.o.ACCESS_TOKEN_WITH_AUTH_SCHEME,b.tokenType){case i.e.POP:var w=s.a.extractTokenClaims(n,f);if(!(null===(E=null==w?void 0:w.cnf)||void 0===E?void 0:E.kid))throw u.a.createTokenClaimsRequiredError();b.keyId=w.cnf.kid;break;case i.e.SSH:b.keyId=v}return b},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===i.o.ACCESS_TOKEN||e.credentialType===i.o.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(o.a)},3305:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3281),o=r(3301),i=r(3283),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.createRefreshTokenEntity=function(e,r,n,o,a,c){var s=new t;return s.clientId=o,s.credentialType=i.o.REFRESH_TOKEN,s.environment=r,s.homeAccountId=e,s.secret=n,s.oboAssertion=c,a&&(s.familyId=a),s},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===i.o.REFRESH_TOKEN)},t}(o.a)},3306:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3283),o=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[n.c,e,t].join(n.D.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(n.c)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}()},3307:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null}},3308:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(3281),i=r(3295),a=r(3291),c=r(3309),s=r(3280);!function(e){e.SW="sw",e.UHW="uhw"}(n||(n={}));var u=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e){return Object(o.b)(this,void 0,void 0,(function(){var t;return Object(o.d)(this,(function(r){switch(r.label){case 0:return[4,this.generateKid(e)];case 1:return t=r.sent(),[2,this.cryptoUtils.base64Encode(JSON.stringify(t))]}}))}))},e.prototype.generateKid=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.d)(this,(function(t){switch(t.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:t.sent(),xms_ksl:n.SW}]}}))}))},e.prototype.signPopToken=function(e,t){var r;return Object(o.b)(this,void 0,void 0,(function(){var n;return Object(o.d)(this,(function(o){if(n=i.a.extractTokenClaims(e,this.cryptoUtils),!(null===(r=null==n?void 0:n.cnf)||void 0===r?void 0:r.kid))throw s.a.createTokenClaimsRequiredError();return[2,this.signPayload(e,n.cnf.kid,t)]}))}))},e.prototype.signPayload=function(e,t,r,n){return Object(o.b)(this,void 0,void 0,(function(){var i,s,u,d,l,h;return Object(o.d)(this,(function(p){switch(p.label){case 0:return i=r.resourceRequestMethod,s=r.resourceRequestUri,u=r.shrClaims,d=r.shrNonce,l=s?new c.a(s):void 0,h=null==l?void 0:l.getUrlComponents(),[4,this.cryptoUtils.signJwt(Object(o.a)({at:e,ts:a.a.nowSeconds(),m:null==i?void 0:i.toUpperCase(),u:null==h?void 0:h.HostNameAndPort,nonce:d||this.cryptoUtils.createNewGuid(),p:null==h?void 0:h.AbsolutePath,q:(null==h?void 0:h.QueryString)?[[],h.QueryString]:void 0,client_claims:u||void 0},n),t)];case 1:return[2,p.sent()]}}))}))},e}()},3309:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3303),o=r(3280),i=r(3279),a=r(3283),c=function(){function e(t){if(this._urlString=t,i.a.isEmpty(this._urlString))throw n.a.createUrlEmptyError();i.a.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return i.a.endsWith(t,"?")?t=t.slice(0,-1):i.a.endsWith(t,"?/")&&(t=t.slice(0,-2)),i.a.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw n.a.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw n.a.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw n.a.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return i.a.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==a.a.COMMON&&n[0]!==a.a.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw n.a.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},o=r.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),r.PathSegments=o,!i.a.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw n.a.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===a.n.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(i.a.isEmpty(t))return{};var r=e.parseHash(t),n=i.a.queryStringToObject(i.a.isEmpty(r)?t:r);if(!n)throw o.a.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(i.a.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}()},3310:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(n||(n={}))},3311:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3281),o=r(3283),i=r(3302),a=r(3303),c=r(3312),s=r(3279),u=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(o.b.RESPONSE_TYPE,encodeURIComponent(o.n.CODE_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(o.b.RESPONSE_MODE,encodeURIComponent(e||o.A.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?Object(n.e)(e||[],o.s):e||[],a=new i.a(r);this.parameters.set(o.b.SCOPE,encodeURIComponent(a.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(o.b.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){c.a.validateRedirectUri(e),this.parameters.set(o.b.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){c.a.validateRedirectUri(e),this.parameters.set(o.b.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(o.b.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(o.C.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(o.C.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(o.r.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(o.r.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(o.C.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);c.a.validateClaims(r),this.parameters.set(o.b.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(o.b.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(o.b.X_CLIENT_SKU,e.sku),this.parameters.set(o.b.X_CLIENT_VER,e.version),this.parameters.set(o.b.X_CLIENT_OS,e.os),this.parameters.set(o.b.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){c.a.validatePrompt(e),this.parameters.set(""+o.b.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){s.a.isEmpty(e)||this.parameters.set(o.b.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(o.b.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(c.a.validateCodeChallengeParams(e,t),!e||!t)throw a.a.createInvalidCodeChallengeParamsError();this.parameters.set(o.b.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(o.b.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(o.b.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(o.b.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(o.b.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(o.b.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(o.b.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(o.b.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(o.b.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(o.b.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(o.b.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(o.b.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set(o.g,"1")},e.prototype.addExtraQueryParameters=function(e){var t=this;c.a.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(n){throw a.a.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(o.l.ACCESS_TOKEN)||(r[o.l.ACCESS_TOKEN]={}),r[o.l.ACCESS_TOKEN][o.l.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(o.u.username,e)},e.prototype.addPassword=function(e){this.parameters.set(o.u.password,e)},e.prototype.addPopToken=function(e){s.a.isEmpty(e)||(this.parameters.set(o.b.TOKEN_TYPE,o.e.POP),this.parameters.set(o.b.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){s.a.isEmpty(e)||(this.parameters.set(o.b.TOKEN_TYPE,o.e.SSH),this.parameters.set(o.b.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(o.b.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(o.b.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(o.b.X_MS_LIB_CAPABILITY,o.F.X_MS_LIB_CAPABILITY_VALUE)},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}()},3312:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3279),o=r(3303),i=r(3283),a=function(){function e(){}return e.validateRedirectUri=function(e){if(n.a.isEmpty(e))throw o.a.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in i.w)t.push(i.w[r]);if(t.indexOf(e)<0)throw o.a.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(t){throw o.a.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(n.a.isEmpty(e)||n.a.isEmpty(t))throw o.a.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([i.m.PLAIN,i.m.S256].indexOf(e)<0)throw o.a.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}()},3313:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(3281),o=r(3314),i=r(3319),a=r(3315),c=r(3283),s=r(3316),u=r(3280),d=r(3310),l=r(3294),h=function(){function e(e){this.config=Object(o.b)(e),this.logger=new a.b(this.config.loggerOptions,s.a,s.b),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new i.a(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[c.r.CONTENT_TYPE]=c.n.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case d.a.HOME_ACCOUNT_ID:try{var r=Object(l.b)(e.credential);t[c.r.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case d.a.UPN:t[c.r.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,o){return Object(n.b)(this,void 0,void 0,(function(){var i;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.networkManager.sendPostRequest(o,e,{body:t,headers:r})];case 1:return i=n.sent(),this.config.serverTelemetryManager&&i.status<500&&429!==i.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,i]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw u.a.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}()},3314:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return g}));var n=r(3281),o=r(3318),i=r(3282),a=r(3315),c=r(3283),s=r(3316),u=r(3317),d={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},l={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:a.a.Info,correlationId:""},h={sendGetRequestAsync:function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",i.a.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",i.a.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},p={sku:c.n.SKU,version:s.b,cpu:"",os:""},f={clientSecret:"",clientAssertion:void 0};function g(e){var t,r=e.authOptions,i=e.systemOptions,a=e.loggerOptions,c=e.storageInterface,s=e.networkInterface,g=e.cryptoInterface,m=e.clientCredentials,y=e.libraryInfo,v=e.serverTelemetryManager,E=e.persistencePlugin,b=e.serializableCache,C=Object(n.a)(Object(n.a)({},l),a);return{authOptions:(t=r,Object(n.a)({clientCapabilities:[]},t)),systemOptions:Object(n.a)(Object(n.a)({},d),i),loggerOptions:C,storageInterface:c||new u.b(r.clientId,o.a),networkInterface:s||h,cryptoInterface:g||o.a,clientCredentials:m||f,libraryInfo:Object(n.a)(Object(n.a)({},p),y),serverTelemetryManager:v||null,persistencePlugin:E||null,serializableCache:b||null}}},3315:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n,o=r(3279),i=r(3283);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(n||(n={}));var a=function(){function e(e,t,r){this.level=n.Info;this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level="number"==typeof e.logLevel?e.logLevel:n.Info,this.correlationId=e.correlationId||"",this.packageName=t||i.n.EMPTY_STRING,this.packageVersion=r||i.n.EMPTY_STRING}return e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),i=(o.a.isEmpty(t.correlationId)?o.a.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+n[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,i,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:n.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:n.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:n.Trace,containsPii:!1,correlationId:t||""})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:n.Trace,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}()},3316:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n="@azure/msal-common",o="5.2.0"},3317:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return h}));var n=r(3281),o=r(3283),i=r(3301),a=r(3302),c=r(3296),s=r(3282),u=r(3280),d=r(3295),l=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),n=Object.keys(r).map((function(e){return r[e]}));return n.length<1?[]:n.map((function(r){var n=e.toObject(new c.a,r).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,n);return o&&!n.idTokenClaims&&(n.idTokenClaims=new d.a(o.secret,t.cryptoImpl).claims),n}))},e.prototype.saveCacheRecord=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){switch(t.label){case 0:if(!e)throw u.a.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o,i,c=this;return Object(n.d)(this,(function(n){switch(n.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType}),r=a.a.fromString(e.target),(o=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]})))?(i=[],o.forEach((function(e){a.a.fromString(e.target).intersectingScopeSets(r)&&i.push(c.removeCredential(e))})),[4,Promise.all(i)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this,o=this.getKeys(),i={};return o.forEach((function(o){var a=n.getAccount(o);a&&(e&&!n.matchHomeAccountId(a,e)||t&&!n.matchEnvironment(a,t)||r&&!n.matchRealm(a,r)||(i[o]=a))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion,e.tokenType,e.keyId)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,a,c,s,u,d,l){var h=this,p=this.getKeys(),f={idTokens:{},accessTokens:{},refreshTokens:{}};return p.forEach((function(p){var g=i.a.getCredentialType(p);if(g!==o.n.NOT_DEFINED){var m=h.getSpecificCredential(p,g);if(m&&(!u||h.matchOboAssertion(m,u))&&(!e||h.matchHomeAccountId(m,e))&&(!t||h.matchEnvironment(m,t))&&(!c||h.matchRealm(m,c))&&(!r||h.matchCredentialType(m,r))&&(!n||h.matchClientId(m,n))&&(!a||h.matchFamilyId(m,a))&&(!s||h.matchTarget(m,s))){if(r===o.o.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(d&&!h.matchTokenType(m,d))return;switch(d){case o.e.POP:if(-1===p.indexOf(o.e.POP))return void h.removeItem(p,o.j.CREDENTIAL);break;case o.e.SSH:if(l&&!h.matchKeyId(m,l))return}}switch(g){case o.o.ID_TOKEN:f.idTokens[p]=m;break;case o.o.ACCESS_TOKEN:case o.o.ACCESS_TOKEN_WITH_AUTH_SCHEME:f.accessTokens[p]=m;break;case o.o.REFRESH_TOKEN:f.refreshTokens[p]=m}}}})),f},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){return Object(n.b)(this,void 0,void 0,(function(){var e,t,r=this;return Object(n.d)(this,(function(n){switch(n.label){case 0:return e=this.getKeys(),t=[],e.forEach((function(e){r.getAccount(e)&&t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2,!0]}}))}))},e.prototype.removeAccount=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw u.a.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,o.j.ACCOUNT)]}}))}))},e.prototype.removeAccountContext=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,a,c=this;return Object(n.d)(this,(function(n){switch(n.label){case 0:return t=this.getKeys(),r=e.generateAccountId(),a=[],t.forEach((function(e){var t=i.a.getCredentialType(e);if(t!==o.n.NOT_DEFINED){var n=c.getSpecificCredential(e,t);n&&r===n.generateAccountId()&&a.push(c.removeCredential(n))}})),[4,Promise.all(a)];case 1:return n.sent(),[2,!0]}}))}))},e.prototype.removeCredential=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==o.o.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==o.e.POP)return[3,4];if(!(r=e.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),u.a.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,o.j.CREDENTIAL)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,o.j.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,r,n,o,i){var a=this.readAccountFromCache(e),c=this.readIdTokenFromCache(t,e),s=this.readAccessTokenFromCache(t,e,r,o,i),u=this.readRefreshTokenFromCache(t,e,!1),l=this.readAppMetadataFromCache(n,t);return a&&c&&(a.idTokenClaims=new d.a(c.secret,this.cryptoImpl).claims),{account:a,idToken:c,accessToken:s,refreshToken:u,appMetadata:l}},e.prototype.readAccountFromCache=function(e){var t=c.a.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:o.o.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),i=Object.keys(n.idTokens).map((function(e){return n.idTokens[e]})),a=i.length;if(a<1)return null;if(a>1)throw u.a.createMultipleMatchingTokensInCacheError();return i[0]},e.prototype.readAccessTokenFromCache=function(e,t,r,n,i){var a=n&&n!==o.e.BEARER?o.o.ACCESS_TOKEN_WITH_AUTH_SCHEME:o.o.ACCESS_TOKEN,c={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:a,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase(),tokenType:n,keyId:i},s=this.getCredentialsFilteredBy(c),d=Object.keys(s.accessTokens).map((function(e){return s.accessTokens[e]})),l=d.length;if(l<1)return null;if(l>1)throw u.a.createMultipleMatchingTokensInCacheError();return d[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?o.E:void 0,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:o.o.REFRESH_TOKEN,clientId:e,familyId:n},a=this.getCredentialsFilteredBy(i),c=Object.keys(a.refreshTokens).map((function(e){return a.refreshTokens[e]}));return c.length<1?null:c[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map((function(e){return n[e]})),i=o.length;if(i<1)return null;if(i>1)throw u.a.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||r.familyId!==o.E)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==o.o.ACCESS_TOKEN&&e.credentialType!==o.o.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var r=a.a.fromString(e.target),n=a.a.fromString(t);return n.containsOnlyOIDCScopes()?n.removeScope(o.n.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),r.containsScopeSet(n)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(o.c)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(o.d.CACHE_KEY)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return o.d.CACHE_KEY+"-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case o.o.ID_TOKEN:return this.getIdTokenCredential(e);case o.o.ACCESS_TOKEN:case o.o.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case o.o.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.setAccount=function(){throw s.a.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw s.a.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw s.a.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw s.a.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw s.a.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw s.a.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw s.a.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw s.a.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw s.a.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw s.a.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw s.a.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw s.a.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw s.a.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw s.a.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw s.a.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw s.a.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw s.a.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw s.a.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw s.a.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw s.a.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",s.a.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t}(l)},3318:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3281),o=r(3282),i={createNewGuid:function(){throw o.a.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw o.a.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw o.a.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",o.a.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",o.a.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",o.a.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",o.a.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",o.a.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))}}},3319:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3281),o=r(3320),i=r(3280),a=r(3282),c=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return Object(n.b)(this,void 0,void 0,(function(){var c,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:o.a.preProcess(this.cacheManager,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return c=n.sent(),[3,4];case 3:throw(s=n.sent())instanceof a.a?s:i.a.createNetworkError(t,s);case 4:return o.a.postProcess(this.cacheManager,e,c),[2,c]}}))}))},e}()},3320:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3283),o=r(3293),i=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return n.F.THROTTLING_PREFIX+"."+JSON.stringify(e)},e.preProcess=function(t,r){var i,a=e.generateThrottlingStorageKey(r),c=t.getThrottlingCache(a);if(c){if(c.throttleTime<Date.now())return void t.removeItem(a,n.j.THROTTLING);throw new o.a((null===(i=c.errorCodes)||void 0===i?void 0:i.join(" "))||n.n.EMPTY_STRING,c.errorMessage,c.subError)}},e.postProcess=function(t,r,o){if(e.checkResponseStatus(o)||e.checkResponseForRetryAfter(o)){var i={throttleTime:e.calculateThrottleTime(parseInt(o.headers[n.r.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),i)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(n.r.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||n.F.DEFAULT_THROTTLE_TIME_SECONDS),r+n.F.DEFAULT_MAX_THROTTLE_TIME_SECONDS))},e.removeThrottle=function(e,t,r,o){var i={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:o,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshJwk:r.sshJwk,sshKid:r.sshKid},a=this.generateThrottlingStorageKey(i);return e.removeItem(a,n.j.THROTTLING)},e}()},3321:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(3278),o=r(3283),i=r(3309),a=r(3325),c=r(3328),s=r(3298),u=r(3279),d=r(3335),l=r(3286),h=r(3326),p=r(3277),f=r(3327),g=r(3322),m=function(e){function t(t,r,n,o,i,a,c){var s=e.call(this,t,r,n,o,i,c)||this;return s.navigationClient=a,s}return Object(n.c)(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(i){switch(i.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=i.sent(),r=Object(n.a)(Object(n.a)({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=o.n.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){if(this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId),this.browserStorage.isInteractionInProgress())throw p.a.createInteractionInProgressError();var t=Object(n.a)({correlationId:this.browserCrypto.createNewGuid()},e);return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=i.a.getAbsoluteUrl(e.postLogoutRedirectUri,g.a.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=i.a.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,g.a.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=i.a.getAbsoluteUrl(g.a.getCurrentUri(),g.a.getCurrentUri())),t},t.prototype.createAuthCodeClient=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new a.a(r)]}}))}))},t.prototype.getClientConfiguration=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return this.logger.verbose("getClientConfiguration called"),[4,this.getDiscoveredAuthority(t)];case 1:return r=n.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:r,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:l.c.MSAL_SKU,version:h.b,cpu:"",os:""}}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){this.logger.verbose("validateAndExtractStateFromHash called",r);var n=i.a.getDeserializedHash(e);if(!n.state)throw p.a.createHashDoesNotContainStateError();var o=f.a.extractBrowserRequestState(this.browserCrypto,n.state);if(!o)throw p.a.createUnableToParseStateError();if(o.interactionType!==t)throw p.a.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),n.state},t.prototype.getDiscoveredAuthority=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,c.a.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]):[3,2];case 1:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,c.a.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)];case 3:return[2,r.sent()]}}))}))},t.prototype.preflightInteractiveRequest=function(e,t){if(this.logger.verbose("preflightInteractiveRequest called, validating app environment",null==e?void 0:e.correlationId),g.a.blockReloadInHiddenIframes(),this.browserStorage.isInteractionInProgress(!1))throw p.a.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},t.prototype.initializeAuthorizationRequest=function(e,t){this.logger.verbose("initializeAuthorizationRequest called");var r=this.getRedirectUri(e.redirectUri),i={interactionType:t},a=s.a.setRequestState(this.browserCrypto,e&&e.state||"",i),c=Object(n.a)(Object(n.a)({},this.initializeBaseRequest(e)),{redirectUri:r,state:a,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:o.A.FRAGMENT}),d=e.account||this.browserStorage.getActiveAccount();if(d&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+d),c.account=d),u.a.isEmpty(c.loginHint)&&!d){var l=this.browserStorage.getLegacyLoginHint();l&&(c.loginHint=l)}return this.browserStorage.updateCacheEntries(c.state,c.nonce,c.authority,c.loginHint||"",c.account||null),c},t}(d.a)},3322:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3283),o=r(3309),i=r(3323),a=r(3324),c=r(3277),s=r(3286),u=function(){function e(){}return e.clearHash=function(e){e.location.hash=n.n.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,n.n.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(s.c.POPUP_NAME_PREFIX+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new o.a(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new i.a:new a.a},e.blockReloadInHiddenIframes=function(){if(o.a.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw c.a.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===s.j.Redirect&&n&&!r)throw c.a.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw c.a.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw c.a.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}()},3323:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3278),o=r(3277),i=r(3286),a=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,a,c;return Object(n.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,fetch(e,{method:i.h.GET,headers:this.getFetchHeaders(t)})];case 1:return r=n.sent(),[3,3];case 2:throw a=n.sent(),window.navigator.onLine?o.a.createGetRequestFailedError(a,e):o.a.createNoNetworkConnectivityError();case 3:return n.trys.push([3,5,,6]),c={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(c.body=n.sent(),c.status=r.status,c)];case 5:throw n.sent(),o.a.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,a,c,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:r=t&&t.body||"",n.label=1;case 1:return n.trys.push([1,3,,4]),[4,fetch(e,{method:i.h.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return a=n.sent(),[3,4];case 3:throw c=n.sent(),window.navigator.onLine?o.a.createPostRequestFailedError(c,e):o.a.createNoNetworkConnectivityError();case 4:return n.trys.push([4,6,,7]),s={headers:this.getHeaderDict(a.headers)},[4,a.json()];case 5:return[2,(s.body=n.sent(),s.status=a.status,s)];case 6:throw n.sent(),o.a.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}()},3324:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3278),o=r(3277),i=r(3286),a=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(r){return[2,this.sendRequestAsync(e,i.h.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(r){return[2,this.sendRequestAsync(e,i.h.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(a,c){var s=new XMLHttpRequest;if(s.open(t,e,!0),n.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&(t===i.h.POST?c(o.a.createPostRequestFailedError("Failed with status "+s.status,e)):c(o.a.createGetRequestFailedError("Failed with status "+s.status,e)));try{var r=JSON.parse(s.responseText),u={headers:n.getHeaderDict(s),body:r,status:s.status};a(u)}catch(d){c(o.a.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===i.h.POST?c(o.a.createPostRequestFailedError("Failed with status "+s.status,e)):c(o.a.createGetRequestFailedError("Failed with status "+s.status,e)):c(o.a.createNoNetworkConnectivityError())},t===i.h.POST&&r&&r.body)s.send(r.body);else{if(t!==i.h.GET)throw o.a.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}()},3325:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(3281),o=r(3313),i=r(3311),a=r(3283),c=r(3292),s=r(3279),u=r(3280),d=r(3309),l=r(3308),h=r(3291),p=r(3294),f=r(3310),g=r(3303),m=r(3312),y=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!0,r}return Object(n.c)(t,e),t.prototype.getAuthCodeUrl=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){return t=this.createAuthCodeUrlQueryString(e),[2,d.a.appendQueryString(this.authority.authorizationEndpoint,t)]}))}))},t.prototype.acquireToken=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,o,i;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(this.logger.info("in acquireToken call"),!e||s.a.isEmpty(e.code))throw u.a.createTokenRequestCannotBeMadeError();return r=h.a.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return o=n.sent(),(i=new c.a(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,r,e,t)];case 2:return[2,n.sent()]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new c.a(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),o=new d.a(e),i=d.a.getDeserializedHash(o.getHash());if(r.validateServerAuthorizationCodeResponse(i,t,this.cryptoUtils),!i.code)throw u.a.createNoAuthCodeInServerResponseError();return Object(n.a)(Object(n.a)({},i),{code:i.code})},t.prototype.getLogoutUri=function(e){if(!e)throw g.a.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return d.a.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,o,i,c,u,d,l;return Object(n.d)(this,(function(n){switch(n.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshJwk:t.sshJwk,sshKid:t.sshKid},[4,this.createTokenRequestBody(t)];case 1:if(o=n.sent(),i=this.createTokenQueryParameters(t),c=void 0,t.clientInfo)try{u=Object(p.a)(t.clientInfo,this.cryptoUtils),c={credential:""+u.uid+a.D.CLIENT_INFO_SEPARATOR+u.utid,type:f.a.HOME_ACCOUNT_ID}}catch(h){this.logger.verbose("Could not parse client info for CCS Header: "+h)}return d=this.createTokenRequestHeaders(c||t.ccsCredential),l=s.a.isEmpty(i)?e.tokenEndpoint:e.tokenEndpoint+"?"+i,[2,this.executePostToTokenEndpoint(l,o,d,r)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new i.a;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o,c,u,d,h;return Object(n.d)(this,(function(n){switch(n.label){case 0:return(t=new i.a).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):m.a.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(a.q.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==a.e.POP?[3,2]:[4,new l.a(this.cryptoUtils).generateCnf(e)];case 1:return o=n.sent(),t.addPopToken(o),[3,3];case 2:if(e.authenticationScheme===a.e.SSH){if(!e.sshJwk)throw g.a.createMissingSshJwkError();t.addSshJwk(e.sshJwk)}n.label=3;case 3:if(c=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(c),(!s.a.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),u=void 0,e.clientInfo)try{d=Object(p.a)(e.clientInfo,this.cryptoUtils),u={credential:""+d.uid+a.D.CLIENT_INFO_SEPARATOR+d.utid,type:f.a.HOME_ACCOUNT_ID}}catch(y){this.logger.verbose("Could not parse client info for CCS Header: "+y)}else u=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&u)switch(u.type){case f.a.HOME_ACCOUNT_ID:try{d=Object(p.b)(u.credential),t.addCcsOid(d)}catch(y){this.logger.verbose("Could not parse home account ID for CCS Header: "+y)}break;case f.a.UPN:t.addCcsUpn(u.credential)}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[a.b.RETURN_SPA_CODE]||t.addExtraQueryParameters(((h={})[a.b.RETURN_SPA_CODE]="1",h)),[2,t.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new i.a;t.addClientId(this.config.authOptions.clientId);var r=Object(n.e)(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var o=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(o),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==a.w.SELECT_ACCOUNT)if(e.sid&&e.prompt===a.w.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var c=this.extractAccountSid(e.account);if(c&&e.prompt===a.w.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(c);try{var u=Object(p.b)(e.account.homeAccountId);t.addCcsOid(u)}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{u=Object(p.b)(e.account.homeAccountId);t.addCcsOid(u)}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!s.a.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.createLogoutUrlQueryString=function(e){var t=new i.a;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},t}(o.a)},3326:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n="@azure/msal-browser",o="2.20.0"},3327:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3279),o=r(3298),i=r(3280),a=r(3309),c=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(n.a.isEmpty(t))return null;try{return o.a.parseRequestState(e,t).libraryState.meta}catch(r){throw i.a.createInvalidStateError(t,r)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new a.a(e);return a.a.getDeserializedHash(t.getHash())},e}()},3328:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3281),o=r(3329),i=r(3303),a=r(3279),c=r(3280),s=function(){function e(){}return e.createDiscoveredInstance=function(t,r,o,i){return Object(n.b)(this,void 0,void 0,(function(){var a,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:a=e.createInstance(t,r,o,i),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,a.resolveEndpointsAsync()];case 2:return n.sent(),[2,a];case 3:throw s=n.sent(),c.a.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n){if(a.a.isEmpty(e))throw i.a.createUrlEmptyError();return new o.a(e,t,r,n)},e}()},3329:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(3281),o=r(3297),i=r(3333),a=r(3309),c=r(3280),s=r(3283),u=r(3303),d=r(3331),l=r(3332),h=r(3334),p=r(3330),f=function(){function e(e,t,r,n){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscovery=new p.a(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0}}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===s.n.ADFS?o.a.Adfs:o.a.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new a.a(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw c.a.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw c.a.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw c.a.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw c.a.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw c.a.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw c.a.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new a.a(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===o.a.Adfs||this.protocolMode===d.a.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return Object(n.b)(this,void 0,void 0,(function(){var e,t,r,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new l.a).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=n.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=n.sent(),t!==s.f.CACHE&&r!==s.f.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(t){var r;return Object(n.b)(this,void 0,void 0,(function(){var o,i,a;return Object(n.d)(this,(function(n){switch(n.label){case 0:return(o=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(o,!1),[2,s.f.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,s.f.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(o=n.sent())?(null===(r=this.authorityOptions.azureRegionConfiguration)||void 0===r?void 0:r.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata)]:[3,3]:[3,4];case 2:i=n.sent(),a=this.authorityOptions.azureRegionConfiguration.azureRegion===s.n.AZURE_REGION_AUTO_DISCOVER_FLAG?i:this.authorityOptions.azureRegionConfiguration.azureRegion,this.authorityOptions.azureRegionConfiguration.azureRegion===s.n.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=i?s.x.AUTO_DETECTION_REQUESTED_SUCCESSFUL:s.x.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=i?this.authorityOptions.azureRegionConfiguration.azureRegion===i?s.x.CONFIGURED_MATCHES_DETECTED:s.x.CONFIGURED_NOT_DETECTED:s.x.CONFIGURED_NO_AUTO_DETECTION,a&&(this.regionDiscoveryMetadata.region_used=a,o=e.replaceWithRegionalInformation(o,a)),n.label=3;case 3:return t.updateEndpointMetadata(o,!0),[2,s.f.NETWORK];case 4:throw c.a.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new a.a(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw u.a.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return Object(n.b)(this,void 0,void 0,(function(){var e;return Object(n.d)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return e=t.sent(),[2,Object(i.a)(e.body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,s.f.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,s.f.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,s.f.NETWORK];throw u.a.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(r)return r}catch(n){throw u.a.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o,i;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=""+s.n.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",r=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return o=n.sent(),0===(i=Object(h.a)(o.body)?o.body.metadata:[]).length?[2,null]:(r=e.getCloudDiscoveryMetadataFromNetworkResponse(i,this.hostnameAndPort),[3,4]);case 3:return n.sent(),[2,null];case 4:return r||(r=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return a.a.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw c.a.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return s.n.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var o=new a.a(e);o.validateAsUri();var i=o.getUrlComponents(),c=t+"."+i.HostNameAndPort;this.isPublicCloudAuthority(i.HostNameAndPort)&&(c=t+"."+s.n.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var u=a.a.constructAuthorityUriFromObject(Object(n.a)(Object(n.a)({},o.getUrlComponents()),{HostNameAndPort:c})).urlString;return r?u+"?"+r:u},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,"allowestsrnonmsi=true"),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e}()},3330:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3281),o=r(3283),i=function(){function e(e){this.networkInterface=e}return e.prototype.detectRegion=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,i,a,c;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(r=e)return[3,8];n.label=1;case 1:return n.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(o.n.IMDS_VERSION)];case 2:return(i=n.sent()).status===o.z.httpSuccess&&(r=i.body,t.region_source=o.y.IMDS),i.status!==o.z.httpBadRequest?[3,5]:[4,this.getCurrentVersion()];case 3:return(a=n.sent())?[4,this.getRegionFromIMDS(a)]:(t.region_source=o.y.FAILED_AUTO_DETECTION,[2,null]);case 4:(c=n.sent()).status===o.z.httpSuccess&&(r=c.body,t.region_source=o.y.IMDS),n.label=5;case 5:return[3,7];case 6:return n.sent(),t.region_source=o.y.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=o.y.ENVIRONMENT_VARIABLE,n.label=9;case 9:return r||(t.region_source=o.y.FAILED_AUTO_DETECTION),[2,r||null]}}))}))},e.prototype.getRegionFromIMDS=function(t){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(r){return[2,this.networkInterface.sendGetRequestAsync(o.n.IMDS_ENDPOINT+"?api-version="+t+"&format=text",e.IMDS_OPTIONS,o.n.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(o.n.IMDS_ENDPOINT+"?format=json",e.IMDS_OPTIONS)];case 1:return(t=r.sent()).status===o.z.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}()},3331:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.AAD="AAD",e.OIDC="OIDC"}(n||(n={}))},3332:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3283),o=r(3291),i=function(){function e(){this.expiresAt=o.a.nowSeconds()+n.d.REFRESH_TIME_SECONDS}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=o.a.nowSeconds()+n.d.REFRESH_TIME_SECONDS},e.prototype.isExpired=function(){return this.expiresAt<=o.a.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(n.d.CACHE_KEY)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt"))},e}()},3333:function(e,t,r){"use strict";function n(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")}r.d(t,"a",(function(){return n}))},3334:function(e,t,r){"use strict";function n(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}r.d(t,"a",(function(){return n}))},3335:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(3278),o=r(3296),i=r(3283),a=r(3303),c=r(3309),s=r(3336),u=r(3326),d=r(3286),l=r(3322),h=function(){function e(e,t,r,n,o,i){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.correlationId=i||this.browserCrypto.createNewGuid(),this.logger=n.clone(d.c.MSAL_SKU,u.b,this.correlationId)}return e.prototype.clearCacheOnLogout=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];o.a.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(o.a.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),this.logger.verbose("No account provided in logout request, clearing all cache items."),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){this.logger.verbose("Initializing BaseAuthRequest");var t=e.authority||this.config.auth.authority,r=Object(n.e)(e&&e.scopes||[]);if(e.authenticationScheme){if(e.authenticationScheme===i.e.SSH){if(!e.sshJwk)throw a.a.createMissingSshJwkError();if(!e.sshKid)throw a.a.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+e.authenticationScheme+'" as configured in Auth request')}else e.authenticationScheme=i.e.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return Object(n.a)(Object(n.a)({},e),{correlationId:this.correlationId,authority:t,scopes:r})},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||l.a.getCurrentUri();return c.a.getAbsoluteUrl(t,l.a.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new s.a(r,this.browserStorage)},e}()},3336:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3283),o=r(3337),i=r(3279),a=function(){function e(e,t){this.cacheOutcome=n.i.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||n.n.EMPTY_STRING,this.wrapperVer=e.wrapperVer||n.n.EMPTY_STRING,this.telemetryCacheKey=n.B.CACHE_KEY+n.D.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+n.B.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(n.B.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(n.B.VALUE_SEPARATOR);return[n.B.SCHEMA_VERSION,r,t].join(n.B.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),o=t.failedRequests.slice(0,2*r).join(n.B.VALUE_SEPARATOR),i=t.errors.slice(0,r).join(n.B.VALUE_SEPARATOR),a=t.errors.length,c=[a,r<a?n.B.OVERFLOW_TRUE:n.B.OVERFLOW_FALSE].join(n.B.VALUE_SEPARATOR);return[n.B.SCHEMA_VERSION,t.cacheHits,o,i,c].join(n.B.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=n.B.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),i.a.isEmpty(e.subError)?i.a.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(n.B.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new o.a;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new o.a;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,o=0,i=e.errors.length;for(t=0;t<i;t++){var a=e.failedRequests[2*t]||n.n.EMPTY_STRING,c=e.failedRequests[2*t+1]||n.n.EMPTY_STRING,s=e.errors[t]||n.n.EMPTY_STRING;if(!((o+=a.toString().length+c.toString().length+s.length+3)<n.B.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||""),e.push(this.regionSource||""),e.push(this.regionOutcome||""),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}()},3337:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3283),o=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(n.B.CACHE_KEY),o=!0;return t&&(o=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&o},e}()},3338:function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var n=r(3278),o=r(3342),i=r(3315),a=r(3318),c=r(3283),s=r(3293),u=r(3284),d=r(3279),l=r(3354),h=r(3339),p=r(3286),f=r(3322),g=r(3326),m=r(3288),y=r(3356),v=r(3353),E=r(3362),b=r(3359),C=r(3365),w=r(3369),T=r(3358),I=r(3367),S=r(3277),A=function(){function e(e){this.isBrowserEnvironment="undefined"!=typeof window,this.config=Object(h.b)(e,this.isBrowserEnvironment),this.logger=new i.b(this.config.system.loggerOptions,g.a,g.b),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.browserCrypto=this.isBrowserEnvironment?new o.a(this.logger):a.a,this.eventHandler=new v.a(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new l.a(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):Object(l.b)(this.config.auth.clientId,this.logger),this.tokenCache=new T.a(this.config,this.browserStorage,this.logger,this.browserCrypto)}return e.prototype.handleRedirectPromise=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o,i,a,s=this;return Object(n.d)(this,(function(n){return this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||c.n.EMPTY_STRING,void 0===(o=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(m.a.HANDLE_REDIRECT_START,p.j.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),i=this.browserStorage.getTemporaryCache(p.l.CORRELATION_ID,!0)||"",a=new b.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,i),o=a.handleRedirectPromise(e).then((function(e){e&&(t.length<s.getAllAccounts().length?(s.eventHandler.emitEvent(m.a.LOGIN_SUCCESS,p.j.Redirect,e),s.logger.verbose("handleRedirectResponse returned result, login success")):(s.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_SUCCESS,p.j.Redirect,e),s.logger.verbose("handleRedirectResponse returned result, acquire token success")));return s.eventHandler.emitEvent(m.a.HANDLE_REDIRECT_END,p.j.Redirect),e})).catch((function(e){throw t.length>0?s.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_FAILURE,p.j.Redirect,null,e):s.eventHandler.emitEvent(m.a.LOGIN_FAILURE,p.j.Redirect,null,e),s.eventHandler.emitEvent(m.a.HANDLE_REDIRECT_END,p.j.Redirect),e})),this.redirectResponse.set(r,o)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,o]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r=this;return Object(n.d)(this,(function(n){return this.preflightBrowserEnvironmentCheck(p.j.Redirect),this.logger.verbose("acquireTokenRedirect called"),(t=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_START,p.j.Redirect,e):this.eventHandler.emitEvent(m.a.LOGIN_START,p.j.Redirect,e),[2,new b.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(e){throw t?r.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_FAILURE,p.j.Redirect,null,e):r.eventHandler.emitEvent(m.a.LOGIN_FAILURE,p.j.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this;try{this.preflightBrowserEnvironmentCheck(p.j.Popup),this.logger.verbose("acquireTokenPopup called",e.correlationId)}catch(n){return Promise.reject(n)}var r=this.getAllAccounts();return r.length>0?this.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_START,p.j.Popup,e):this.eventHandler.emitEvent(m.a.LOGIN_START,p.j.Popup,e),new E.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).then((function(e){return r.length<t.getAllAccounts().length?t.eventHandler.emitEvent(m.a.LOGIN_SUCCESS,p.j.Popup,e):t.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_SUCCESS,p.j.Popup,e),e})).catch((function(e){return r.length>0?t.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_FAILURE,p.j.Popup,null,e):t.eventHandler.emitEvent(m.a.LOGIN_FAILURE,p.j.Popup,null,e),Promise.reject(e)}))},e.prototype.ssoSilent=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:this.preflightBrowserEnvironmentCheck(p.j.Silent),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(m.a.SSO_SILENT_START,p.j.Silent,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,new C.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,p.a.ssoSilent,e.correlationId).acquireToken(e)];case 2:return t=n.sent(),this.eventHandler.emitEvent(m.a.SSO_SILENT_SUCCESS,p.j.Silent,t),[2,t];case 3:throw r=n.sent(),this.eventHandler.emitEvent(m.a.SSO_SILENT_FAILURE,p.j.Silent,null,r),r;case 4:return[2]}}))}))},e.prototype.acquireTokenByCode=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r=this;return Object(n.d)(this,(function(n){this.preflightBrowserEnvironmentCheck(p.j.Silent),this.logger.trace("acquireTokenByCode called",e.correlationId),this.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_BY_CODE_START,p.j.Silent,e);try{if(!e.code)throw S.a.createAuthCodeRequiredError();return(t=this.hybridAuthCodeResponses.get(e.code))?this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId):(this.logger.verbose("Initiating new acquireTokenByCode request",e.correlationId),t=this.acquireTokenByCodeAsync(e).then((function(t){return r.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_BY_CODE_SUCCESS,p.j.Silent,t),r.hybridAuthCodeResponses.delete(e.code),t})).catch((function(t){throw r.hybridAuthCodeResponses.delete(e.code),t})),this.hybridAuthCodeResponses.set(e.code,t)),[2,t]}catch(o){throw this.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_BY_CODE_FAILURE,p.j.Silent,null,o),o}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){switch(t.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),[4,new I.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,p.a.acquireTokenByCode,e.correlationId).acquireToken(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t=this;return Object(n.d)(this,(function(r){return this.eventHandler.emitEvent(m.a.ACQUIRE_TOKEN_NETWORK_START,p.j.Silent,e),f.a.blockReloadInHiddenIframes(),[2,new w.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(r){var n=r instanceof s.a,o=r instanceof u.a,i=r.errorCode===p.c.INVALID_GRANT_ERROR;if(n&&i&&!o)return t.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId),new C.a(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,p.a.acquireTokenSilent_authCode,e.correlationId).acquireToken(e);throw r}))]}))}))},e.prototype.logout=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]}))}))},e.prototype.logoutRedirect=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){return this.preflightBrowserEnvironmentCheck(p.j.Redirect),[2,new b.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{return this.preflightBrowserEnvironmentCheck(p.j.Popup),new E.a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)}catch(t){return Promise.reject(t)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!d.a.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!d.a.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!d.a.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),f.a.blockNonBrowserEnvironment(this.isBrowserEnvironment),f.a.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),f.a.blockReloadInHiddenIframes(),f.a.blockAcquireTokenInPopups(),e===p.j.Redirect&&this.config.cache.cacheLocation===p.b.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw y.a.createInMemoryRedirectUnavailableError()},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e}()},3339:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p}));var n=r(3278),o=r(3283),i=r(3331),a=r(3315),c=r(3314),s=r(3340),u=r(3322),d=r(3286),l=r(3341),h=6e3;function p(e,t){var r=e.auth,p=e.cache,f=e.system,g={clientId:"",authority:""+o.n.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:i.a.AAD},m={cacheLocation:d.b.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},y={loggerCallback:function(){},logLevel:a.a.Info,piiLoggingEnabled:!1},v=Object(n.a)(Object(n.a)({},c.a),{loggerOptions:y,networkClient:t?u.a.getBrowserNetworkClient():s.a,navigationClient:new l.a,loadFrameTimeout:0,windowHashTimeout:f&&f.loadFrameTimeout||6e4,iframeHashTimeout:f&&f.loadFrameTimeout||h,navigateFrameWait:t&&u.a.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1});return{auth:Object(n.a)(Object(n.a)({},g),r),cache:Object(n.a)(Object(n.a)({},m),p),system:Object(n.a)(Object(n.a)({},v),f)}}},3340:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3282),o={sendGetRequestAsync:function(){return Promise.reject(n.a.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(n.a.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}}},3341:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}()},3342:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(3278),o=r(3347),i=r(3345),a=r(3346),c=r(3349),s=r(3343),u=r(3344),d=r(3286),l=r(3277),h=r(3350),p=function(){function e(e){this.logger=e,this.browserCrypto=new s.a(this.logger),this.b64Encode=new i.a,this.b64Decode=new a.a,this.guidGenerator=new o.a(this.browserCrypto),this.pkceGenerator=new c.a(this.browserCrypto),this.cache={asymmetricKeys:new h.a(this.logger),symmetricKeys:new h.a(this.logger)}}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){return Object(n.b)(this,void 0,void 0,(function(){var r,o,i,a,c,u,d,l;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return r=n.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return o=n.sent(),i={e:o.e,kty:o.kty,n:o.n},a=s.a.getJwkString(i),[4,this.browserCrypto.sha256Digest(a)];case 3:return c=n.sent(),u=this.b64Encode.urlEncodeArr(new Uint8Array(c)),[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:return d=n.sent(),[4,this.browserCrypto.importJwk(d,!1,["sign"])];case 5:return l=n.sent(),[4,this.cache.asymmetricKeys.setItem(u,{privateKey:l,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return n.sent(),[2,u]}}))}))},e.prototype.removeTokenBindingKey=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return Object(n.b)(this,void 0,void 0,(function(){var e,t,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return e=Object.keys(this.cache),(t=this.cache[e[0]])?[4,t.deleteDatabase()]:[3,2];case 1:return r=n.sent(),[3,3];case 2:r=!1,n.label=3;case 3:return[2,r]}}))}))},e.prototype.signJwt=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r,o,i,a,c,h,p,f,g,m;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(r=n.sent()))throw l.a.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return o=n.sent(),i=s.a.getJwkString(o),a={alg:o.alg,type:d.k},c=this.b64Encode.urlEncode(JSON.stringify(a)),e.cnf={jwk:JSON.parse(i)},h=this.b64Encode.urlEncode(JSON.stringify(e)),p=c+"."+h,f=u.a.stringToArrayBuffer(p),[4,this.browserCrypto.sign(r.privateKey,f)];case 3:return g=n.sent(),m=this.b64Encode.urlEncodeArr(new Uint8Array(g)),[2,p+"."+m]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}()},3343:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3278),o=r(3344),i=r(3277),a=r(3286),c=new Uint8Array([1,0,1]),s=function(){function e(e){if(this.logger=e,!this.hasCryptoAPI())throw i.a.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256",modulusLength:2048,publicExponent:c}}return e.prototype.sha256Digest=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){return t=o.a.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest("SHA-256",t):this.getSubtleCryptoDigest("SHA-256",t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw i.a.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(a.k,e)]}))}))},e.prototype.importJwk=function(t,r,i){return Object(n.b)(this,void 0,void 0,(function(){var c,s;return Object(n.d)(this,(function(n){return c=e.getJwkString(t),s=o.a.stringToArrayBuffer(c),[2,this.hasIECrypto()?this.msCryptoImportKey(s,r,i):window.crypto.subtle.importKey(a.k,t,this._keygenAlgorithmOptions,r,i)]}))}))},e.prototype.sign=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r=this;return Object(n.d)(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(a.k,e);n.addEventListener("complete",(function(e){var n=e.target.result,i=o.a.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(i))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,r){return Object(n.b)(this,void 0,void 0,(function(){var o=this;return Object(n.d)(this,(function(n){return[2,new Promise((function(n,i){var c=window.msCrypto.subtle.importKey(a.k,e,o._keygenAlgorithmOptions,t,r);c.addEventListener("complete",(function(e){n(e.target.result)})),c.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r=this;return Object(n.d)(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}()},3344:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,c=0;a<r;c++)(t=e.charCodeAt(c))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e}()},3345:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3344),o=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=n.a.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}()},3346:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3344),o=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return n.a.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,c=void 0,s=0,u=0,d=0;d<n;d++)if(c=3&d,s|=this.b64ToUint6(r.charCodeAt(d))<<18-6*c,3===c||n-d==1){for(a=0;a<3&&u<o;a++,u++)i[u]=s>>>(16>>>a&24)&255;s=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}()},3347:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3348),o=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,n.a.decimalToHex(e[0])+n.a.decimalToHex(e[1])+n.a.decimalToHex(e[2])+n.a.decimalToHex(e[3])+"-"+n.a.decimalToHex(e[4])+n.a.decimalToHex(e[5])+"-"+n.a.decimalToHex(e[6])+n.a.decimalToHex(e[7])+"-"+n.a.decimalToHex(e[8])+n.a.decimalToHex(e[9])+"-"+n.a.decimalToHex(e[10])+n.a.decimalToHex(e[11])+n.a.decimalToHex(e[12])+n.a.decimalToHex(e[13])+n.a.decimalToHex(e[14])+n.a.decimalToHex(e[15])}catch(c){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",a=0;a<36;a++)"-"!==t[a]&&"4"!==t[a]&&(o=16*Math.random()|0),"x"===t[a]?i+=r[o]:"y"===t[a]?(o&=3,i+=r[o|=8]):i+=t[a];return i}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}()},3348:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}()},3349:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3278),o=r(3277),i=r(3345),a=function(){function e(e){this.base64Encode=new i.a,this.cryptoObj=e}return e.prototype.generateCodes=function(){return Object(n.b)(this,void 0,void 0,(function(){var e,t;return Object(n.d)(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(t){throw o.a.createPkceNotGeneratedError(t)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),o.a.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}()},3350:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3278),o=r(3277),i=r(3352),a=r(3351),c=function(){function e(e){this.inMemoryCache=new a.a,this.indexedDBCache=new i.a,this.logger=e}return e.prototype.handleDatabaseAccessError=function(e){e instanceof o.a&&e.errorCode===o.b.databaseUnavailable.code&&this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r;return Object(n.d)(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return Object(n.b)(this,void 0,void 0,(function(){var e,t;return Object(n.d)(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clear=function(){return Object(n.b)(this,void 0,void 0,(function(){var e;return Object(n.d)(this,(function(t){switch(t.label){case 0:this.inMemoryCache.clear(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),this.handleDatabaseAccessError(e),[3,4];case 4:return[2]}}))}))},e}()},3351:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}()},3352:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3278),o=r(3277),i=r(3286),a=function(){function e(){this.dbName=i.d,this.version=i.f,this.tableName=i.e,this.dbOpen=!1}return e.prototype.open=function(){return Object(n.b)(this,void 0,void 0,(function(){var e=this;return Object(n.d)(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(o.a.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.validateDbIsOpen=function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t=this;return Object(n.d)(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(o.a.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);i.addEventListener("success",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r=this;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,i){if(!r.db)return i(o.a.createDatabaseNotOpenError());var a=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);a.addEventListener("success",(function(){return n()})),a.addEventListener("error",(function(e){return i(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t=this;return Object(n.d)(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(o.a.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);i.addEventListener("success",(function(){return r()})),i.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return Object(n.b)(this,void 0,void 0,(function(){var e=this;return Object(n.d)(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(o.a.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(e){t(e.target.result)})),n.addEventListener("error",(function(e){return r(e)}))}))]}}))}))},e.prototype.containsKey=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t=this;return Object(n.d)(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(o.a.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);i.addEventListener("success",(function(e){r(1===e.target.result)})),i.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return Object(n.b)(this,void 0,void 0,(function(){return Object(n.d)(this,(function(e){return[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase(i.d);r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}()},3353:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3296),o=r(3317),i=r(3288);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!==a(r)||!n.a.isAccountEntity(r))return;var c=o.a.toObject(new n.a,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(i.a.ACCOUNT_ADDED,void 0,c)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(i.a.ACCOUNT_REMOVED,void 0,c))}catch(e){return}},e}()},3354:function(e,t,r){"use strict";r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return A}));var n=r(3278),o=r(3283),i=r(3296),a=r(3317),c=r(3300),s=r(3304),u=r(3305),d=r(3306),l=r(3337),h=r(3332),p=r(3357),f=r(3279),g=r(3298),m=r(3310),y=r(3295),v=r(3318),E=r(3277),b=r(3286),C=r(3355),w=r(3351),T=r(3327);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var S=function(e){function t(t,r,n,o){var i=e.call(this,t,n)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new w.a,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return Object(n.c)(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case b.b.LocalStorage:case b.b.SessionStorage:try{return new C.a(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=b.b.MemoryStorage,new w.a},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case b.b.LocalStorage:case b.b.SessionStorage:try{return new C.a(b.b.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case b.b.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=o.n.CACHE_PREFIX+"."+o.v.ID_TOKEN,r=o.n.CACHE_PREFIX+"."+o.v.CLIENT_INFO,n=o.n.CACHE_PREFIX+"."+o.v.ERROR,i=o.n.CACHE_PREFIX+"."+o.v.ERROR_DESC,a=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(i)];[o.v.ID_TOKEN,o.v.CLIENT_INFO,o.v.ERROR,o.v.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,a[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"===I(t)?t:null}catch(r){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&i.a.isAccountEntity(r)?a.a.toObject(new i.a,r):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&c.a.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),a.a.toObject(new c.a,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&s.a.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),a.a.toObject(new s.a,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&u.a.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),a.a.toObject(new u.a,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&d.a.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),a.a.toObject(new d.a,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&l.a.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),a.a.toObject(new l.a,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&h.a.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),a.a.toObject(new h.a,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(b.i.WRAPPER_SKU,e),this.internalStorage.setItem(b.i.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(b.i.WRAPPER_SKU)||"",this.internalStorage.getItem(b.i.WRAPPER_VER)||""]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(o.v.ACTIVE_ACCOUNT),t=this.browserStorage.getItem(e);return t&&this.getAccountInfoByFilter({localAccountId:t})[0]||null},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(o.v.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(t,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t))},t.prototype.getAccountInfoByFilter=function(e){return this.getAllAccounts().filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&p.a.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),a.a.toObject(new p.a,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===b.b.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return Object(n.e)(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return Object(n.b)(this,void 0,void 0,(function(){var e=this;return Object(n.d)(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(o.n.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},t.prototype.clearMsalCookies=function(){var e=this,t=o.n.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):f.a.startsWith(e,o.n.CACHE_PREFIX)||f.a.startsWith(e,o.v.ADAL_ID_TOKEN)?e:o.n.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=g.a.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(b.l.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=g.a.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(b.l.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=g.a.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(b.l.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,r,!1),o){var s={credential:o.homeAccountId,type:m.a.HOME_ACCOUNT_ID};this.setTemporaryCache(b.l.CCS_CREDENTIAL,JSON.stringify(s),!0)}else if(!f.a.isEmpty(n)){s={credential:n,type:m.a.UPN};this.setTemporaryCache(b.l.CCS_CREDENTIAL,JSON.stringify(s),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),f.a.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(b.l.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(b.l.ORIGIN_URI)),this.removeItem(this.generateCacheKey(b.l.URL_HASH)),this.removeItem(this.generateCacheKey(b.l.CORRELATION_ID)),this.removeItem(this.generateCacheKey(b.l.CCS_CREDENTIAL)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(b.l.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=T.a.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies()},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(b.l.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(b.l.REQUEST_PARAMS,!0);if(!r)throw E.a.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw E.a.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(b.l.REQUEST_PARAMS)),f.a.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw E.a.createNoCachedAuthorityError();n.authority=i}return n},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=o.n.CACHE_PREFIX+"."+b.l.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=this.getInteractionInProgress(),r=o.n.CACHE_PREFIX+"."+b.l.INTERACTION_STATUS_KEY;e&&!t?this.setTemporaryCache(r,this.clientId,!1):e||t!==this.clientId||this.removeItem(r)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(o.v.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(o.v.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(o.v.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(o.v.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new y.a(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t}(a.a),A=function(e,t){var r={cacheLocation:b.b.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};return new S(e,r,v.a,t)}},3355:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3356),o=r(3286),i=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==o.b.LocalStorage&&e!==o.b.SessionStorage)throw n.a.createStorageNotSupportedError(e);if(!!!window[e])throw n.a.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}()},3356:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(3278),o=r(3282),i={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},a={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},c={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},s={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},u={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},d={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},l=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return Object(n.c)(t,e),t.createRedirectUriEmptyError=function(){return new t(i.code,i.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(a.code,a.desc)},t.createStorageNotSupportedError=function(e){return new t(c.code,c.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(s.code,s.desc)},t.createStubPcaInstanceCalledError=function(){return new t(u.code,u.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(d.code,d.desc)},t}(o.a)},3357:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3283),o=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(n.F.THROTTLING_PREFIX));var o=!0;return t&&(o=t.hasOwnProperty("throttleTime")),r&&o},e}()},3358:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(3329),o=r(3300),i=r(3295),a=r(3296),c=r(3302),s=r(3304),u=r(3277),d=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw u.a.createUnableToLoadTokenError("Please ensure server response includes id token.");if(e.account)this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,r);else{if(!e.authority)throw u.a.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},i=new n.a(e.authority,this.config.system.networkClient,this.storage,o);if(r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(t.id_token,r.clientInfo,i.hostnameAndPort,i.tenant,r),this.loadAccessToken(e,t,r.clientInfo,i.hostnameAndPort,i.tenant,r);else{if(!t.client_info)throw u.a.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(t.id_token,t.client_info,i.hostnameAndPort,i.tenant,r),this.loadAccessToken(e,t,t.client_info,i.hostnameAndPort,i.tenant,r)}}},e.prototype.loadIdToken=function(e,t,r,n,c){var s=o.a.createIdTokenEntity(t,r,e,this.config.auth.clientId,n),d=new i.a(e,this.cryptoObj),l=c.clientInfo?a.a.createAccount(c.clientInfo,t,d,void 0,void 0,void 0,void 0,r):a.a.createGenericAccount(t,d,void 0,void 0,void 0,void 0,r);if(!this.isBrowserEnvironment)throw u.a.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(l),this.storage.setIdTokenCredential(s)},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(t.access_token){if(!t.expires_in)throw u.a.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw u.a.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new c.a(e.scopes).printScopes(),d=t.expires_in,l=i.extendedExpiresOn,h=s.a.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,a,d,l,this.cryptoObj);if(!this.isBrowserEnvironment)throw u.a.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(h)}else this.logger.verbose("TokenCache - No access token provided for caching")},e}()},3359:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(3278),o=r(3282),i=r(3309),a=r(3321),c=r(3286),s=r(3360),u=r(3322),d=r(3288),l=r(3277),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,i,a,u,d,l,h;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=this.preflightInteractiveRequest(e,c.j.Redirect),r=this.initializeServerTelemetryManager(c.a.acquireTokenRedirect),n.label=1;case 1:return n.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return i=n.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return a=n.sent(),this.logger.verbose("Auth code client created"),u=new s.a(a,this.browserStorage,i,this.logger,this.browserCrypto),[4,a.getAuthCodeUrl(t)];case 4:return d=n.sent(),l=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+l),[4,u.initiateAuthRequest(d,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate})];case 5:return[2,n.sent()];case 6:throw(h=n.sent())instanceof o.a&&h.setCorrelationId(this.correlationId),r.cacheFailedRequest(h),this.browserStorage.cleanRequestByState(t.state),h;case 7:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,a,s,d,l,h,p,f,g,m;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=this.initializeServerTelemetryManager(c.a.handleRedirectPromise),n.label=1;case 1:if(n.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(c.j.Redirect),[2,null];a=void 0;try{a=this.validateAndExtractStateFromHash(r,c.j.Redirect),u.a.clearHash(window),this.logger.verbose("State extracted from hash")}catch(y){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+y),this.browserStorage.cleanRequestByInteractionType(c.j.Redirect),[2,null]}return s=this.browserStorage.getTemporaryCache(c.l.ORIGIN_URI,!0)||"",d=i.a.removeHashFromUrl(s),l=i.a.removeHashFromUrl(window.location.href),d===l&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,a,t)]):[3,3];case 2:return h=n.sent(),s.indexOf("#")>-1&&u.a.replaceHash(s),[2,h];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,a,t)]);case 4:return u.a.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(c.l.URL_HASH,r,!0),p={apiId:c.a.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},f=!0,s&&"null"!==s?[3,6]:(g=u.a.getHomepage(),this.browserStorage.setTemporaryCache(c.l.ORIGIN_URI,g,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(g,p)]));case 5:return f=n.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+s),[4,this.navigationClient.navigateInternal(s,p)];case 7:f=n.sent(),n.label=8;case 8:if(!f)return[2,this.handleHash(r,a,t)];n.label=9;case 9:return[2,null];case 10:throw(m=n.sent())instanceof o.a&&m.setCorrelationId(this.correlationId),t.cacheFailedRequest(m),this.browserStorage.cleanRequestByInteractionType(c.j.Redirect),m;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){this.logger.verbose("getRedirectResponseHash called");var t=i.a.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(c.l.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(c.l.URL_HASH)),t?(this.logger.verbose("Hash contains known properties, returning response hash"),e):(this.logger.verbose("Hash does not contain known properties, returning cached hash"),r)},t.prototype.handleHash=function(e,t,r){return Object(n.b)(this,void 0,void 0,(function(){var o,i,a;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(o=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),!(i=this.browserStorage.getCachedAuthority(t)))throw l.a.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(r,i)];case 1:return a=n.sent(),this.logger.verbose("Auth code client created"),[4,new s.a(a,this.browserStorage,o,this.logger,this.browserCrypto).handleCodeResponseFromHash(e,t,a.authority,this.networkClient,this.config.auth.clientId)];case 2:return[2,n.sent()]}}))}))},t.prototype.logout=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,i,a,s,u;return Object(n.d)(this,(function(n){switch(n.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(c.a.logout),n.label=1;case 1:return n.trys.push([1,10,,11]),this.eventHandler.emitEvent(d.a.LOGOUT_START,c.j.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return n.sent(),i={apiId:c.a.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return a=n.sent(),this.logger.verbose("Auth code client created"),s=a.getLogoutUri(t),this.eventHandler.emitEvent(d.a.LOGOUT_SUCCESS,c.j.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(s)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(s,i)]):[3,7];case 4:return n.sent(),[2];case 5:this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),n.label=6;case 6:return[3,9];case 7:return[4,this.navigationClient.navigateExternal(s,i)];case 8:return n.sent(),[2];case 9:return[3,11];case 10:throw(u=n.sent())instanceof o.a&&u.setCorrelationId(this.correlationId),r.cacheFailedRequest(u),this.eventHandler.emitEvent(d.a.LOGOUT_FAILURE,c.j.Redirect,null,u),this.eventHandler.emitEvent(d.a.LOGOUT_END,c.j.Redirect),u;case 11:return this.eventHandler.emitEvent(d.a.LOGOUT_END,c.j.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return i.a.getAbsoluteUrl(t,u.a.getCurrentUri())},t}(a.a)},3360:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3278),o=r(3279),i=r(3280),a=r(3320),c=r(3277),s=r(3286),u=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r,n,o)||this;return a.browserCrypto=i,a}return Object(n.c)(t,e),t.prototype.initiateAuthRequest=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),o.a.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(s.l.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setInteractionInProgress(!0),this.browserStorage.setTemporaryCache(s.l.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:s.a.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:return n.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 5:return n.sent(),[2];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),c.a.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,s,u){return Object(n.b)(this,void 0,void 0,(function(){var d,l,h,p,f,g,m;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),o.a.isEmpty(e))throw c.a.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),d=this.browserStorage.generateStateKey(t),!(l=this.browserStorage.getTemporaryCache(d)))throw i.a.createStateNotFoundError("Cached State");return h=this.authModule.handleFragmentResponse(e,l),p=this.browserStorage.generateNonceKey(l),f=this.browserStorage.getTemporaryCache(p),this.authCodeRequest.code=h.code,h.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(h.cloud_instance_host_name,r,s)]:[3,2];case 1:n.sent(),n.label=2;case 2:return h.nonce=f||void 0,h.state=l,h.client_info?this.authCodeRequest.clientInfo=h.client_info:(g=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=g),u&&a.a.removeThrottle(this.browserStorage,u,this.authCodeRequest),[4,this.authModule.acquireToken(this.authCodeRequest,h)];case 3:return m=n.sent(),this.browserStorage.cleanRequestByState(t),[2,m]}}))}))},t}(r(3361).a)},3361:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3278),o=r(3279),i=r(3280),a=r(3328),c=r(3277),s=r(3286),u=function(){function e(e,t,r,n){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.browserRequestLogger=n}return e.prototype.handleCodeResponseFromHash=function(e,t,r,a){return Object(n.b)(this,void 0,void 0,(function(){var s,u,d;return Object(n.d)(this,(function(n){if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),o.a.isEmpty(e))throw c.a.createEmptyHashError(e);if(s=this.browserStorage.generateStateKey(t),!(u=this.browserStorage.getTemporaryCache(s)))throw i.a.createStateNotFoundError("Cached State");return d=this.authModule.handleFragmentResponse(e,u),[2,this.handleCodeResponseFromServer(d,t,r,a)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,o,a){return void 0===a&&(a=!0),Object(n.b)(this,void 0,void 0,(function(){var c,s,u,d,l,h;return Object(n.d)(this,(function(n){switch(n.label){case 0:if(this.browserRequestLogger.trace("InteractionHandler.handleCodeResponseFromServer called"),c=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(c)))throw i.a.createStateNotFoundError("Cached State");return u=this.browserStorage.generateNonceKey(s),d=this.browserStorage.getTemporaryCache(u),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,o)]:[3,2];case 1:n.sent(),n.label=2;case 2:return a&&(e.nonce=d||void 0),e.state=s,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(l=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=l),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return h=n.sent(),this.browserStorage.cleanRequestByState(t),[2,h]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return Object(n.b)(this,void 0,void 0,(function(){var o,i;return Object(n.d)(this,(function(n){switch(n.label){case 0:return o="https://"+e+"/"+t.tenant+"/",[4,a.a.createDiscoveredInstance(o,r,this.browserStorage,t.options)];case 1:return i=n.sent(),this.authModule.updateAuthority(i),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(s.l.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}()},3362:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(3278),o=r(3320),i=r(3282),a=r(3309),c=r(3321),s=r(3363),u=r(3288),d=r(3286),l=r(3364),h=r(3322),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){try{var t=this.preflightInteractiveRequest(e,d.j.Popup),r=s.a.generatePopupName(this.config.auth.clientId,t),n=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,r,n);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var o=s.a.openSizedPopup("about:blank",r,n,this.logger);return this.acquireTokenPopupAsync(t,r,n,o)}catch(i){return Promise.reject(i)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=s.a.generateLogoutPopupName(this.config.auth.clientId,t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var a=s.a.openSizedPopup("about:blank",r,i,this.logger);return this.logoutPopupAsync(t,r,i,n,a,o)}catch(c){return Promise.reject(c)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,a){return Object(n.b)(this,void 0,void 0,(function(){var c,s,h,p,f,g,m,y,v,E;return Object(n.d)(this,(function(n){switch(n.label){case 0:this.logger.verbose("acquireTokenPopupAsync called"),c=this.initializeServerTelemetryManager(d.a.acquireTokenPopup),n.label=1;case 1:return n.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return s=n.sent(),[4,this.createAuthCodeClient(c,e.authority)];case 3:return h=n.sent(),this.logger.verbose("Auth code client created"),[4,h.getAuthCodeUrl(e)];case 4:return p=n.sent(),f=new l.a(h,this.browserStorage,s,this.logger),g={popup:a,popupName:t,popupWindowAttributes:r},m=f.initiateAuthRequest(p,g),this.eventHandler.emitEvent(u.a.POPUP_OPENED,d.j.Popup,{popupWindow:m},null),[4,f.monitorPopupForHash(m)];case 5:return y=n.sent(),v=this.validateAndExtractStateFromHash(y,d.j.Popup,e.correlationId),o.a.removeThrottle(this.browserStorage,this.config.auth.clientId,s),[4,f.handleCodeResponseFromHash(y,v,h.authority,this.networkClient)];case 6:return[2,n.sent()];case 7:throw E=n.sent(),a&&a.close(),E instanceof i.a&&E.setCorrelationId(this.correlationId),c.cacheFailedRequest(E),this.browserStorage.cleanRequestByState(e.state),E;case 8:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,o,c,l){return Object(n.b)(this,void 0,void 0,(function(){var p,f,g,m,y,v,E,b,C;return Object(n.d)(this,(function(n){switch(n.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(u.a.LOGOUT_START,d.j.Popup,e),p=this.initializeServerTelemetryManager(d.a.logoutPopup),n.label=1;case 1:return n.trys.push([1,8,,9]),[4,this.clearCacheOnLogout(e.account)];case 2:return n.sent(),this.browserStorage.setInteractionInProgress(!0),[4,this.createAuthCodeClient(p,o)];case 3:f=n.sent(),this.logger.verbose("Auth code client created"),g=f.getLogoutUri(e),this.eventHandler.emitEvent(u.a.LOGOUT_SUCCESS,d.j.Popup,e),m=new s.a(this.browserStorage,this.logger),y=m.openPopup(g,{popupName:t,popupWindowAttributes:r,popup:c}),this.eventHandler.emitEvent(u.a.POPUP_OPENED,d.j.Popup,{popupWindow:y},null),n.label=4;case 4:return n.trys.push([4,6,,7]),[4,m.monitorPopupForSameOrigin(y)];case 5:return n.sent(),this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,7];case 6:return v=n.sent(),this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+v),[3,7];case 7:return m.cleanPopup(y),l?(E={apiId:d.a.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},b=a.a.getAbsoluteUrl(l,h.a.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecing main window to: "+b),this.navigationClient.navigateInternal(b,E)):this.logger.verbose("No main window navigation requested"),[3,9];case 8:throw C=n.sent(),c&&c.close(),C instanceof i.a&&C.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(u.a.LOGOUT_FAILURE,d.j.Popup,null,C),this.eventHandler.emitEvent(u.a.LOGOUT_END,d.j.Popup),p.cacheFailedRequest(C),C;case 9:return this.eventHandler.emitEvent(u.a.LOGOUT_END,d.j.Popup),[2]}}))}))},t}(c.a)},3363:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(3283),o=r(3279),i=r(3277),a=r(3286),c=function(){function e(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return e.prototype.openPopup=function(t,r){try{var n=void 0;if(r.popup?(n=r.popup,this.logger.verbosePii("Navigating popup window to: "+t),n.location.assign(t)):void 0===r.popup&&(this.logger.verbosePii("Opening popup window to: "+t),n=e.openSizedPopup(t,r.popupName,r.popupWindowAttributes,this.logger)),!n)throw i.a.createEmptyWindowCreatedError();return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(o){throw this.logger.error("error opening popup "+o.message),this.browserStorage.setInteractionInProgress(!1),i.a.createPopupWindowError(o.toString())}},e.openSizedPopup=function(e,t,r,n){var o,i,c,s,u=window.screenLeft?window.screenLeft:window.screenX,d=window.screenTop?window.screenTop:window.screenY,l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,p=null===(o=r.popupSize)||void 0===o?void 0:o.width,f=null===(i=r.popupSize)||void 0===i?void 0:i.height,g=null===(c=r.popupPosition)||void 0===c?void 0:c.top,m=null===(s=r.popupPosition)||void 0===s?void 0:s.left;return(!p||p<0||p>l)&&(n.verbose("Default popup window width used. Window width not configured or invalid."),p=a.c.POPUP_WIDTH),(!f||f<0||f>h)&&(n.verbose("Default popup window height used. Window height not configured or invalid."),f=a.c.POPUP_HEIGHT),(!g||g<0||g>h)&&(n.verbose("Default popup window top position used. Window top not configured or invalid."),g=Math.max(0,h/2-a.c.POPUP_HEIGHT/2+d)),(!m||m<0||m>l)&&(n.verbose("Default popup window left position used. Window left not configured or invalid."),m=Math.max(0,l/2-a.c.POPUP_WIDTH/2+u)),window.open(e,t,"width="+p+", height="+f+", top="+g+", left="+m+", scrollbars=yes")},e.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(a.j.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},e.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise((function(r,c){var s=setInterval((function(){if(e.closed)return t.cleanPopup(),clearInterval(s),void c(i.a.createUserCancelledError());var a=n.n.EMPTY_STRING;try{a=e.location.href}catch(u){}o.a.isEmpty(a)||"about:blank"===a||(clearInterval(s),r())}),a.c.POLL_INTERVAL_MS)}))},e.generatePopupName=function(e,t){return a.c.POPUP_NAME_PREFIX+"."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},e.generateLogoutPopupName=function(e,t){var r=t.account&&t.account.homeAccountId;return a.c.POPUP_NAME_PREFIX+"."+e+"."+r+"."+t.correlationId},e}()},3364:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(3278),o=r(3279),i=r(3309),a=r(3361),c=r(3277),s=r(3363),u=r(3322),d=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;return i.popupUtils=new s.a(r,o),i}return Object(n.c)(t,e),t.prototype.initiateAuthRequest=function(e,t){if(o.a.isEmpty(e))throw this.browserRequestLogger.error("Navigate url is empty"),c.a.createEmptyNavigationUriError();return this.browserStorage.setInteractionInProgress(!0),this.browserRequestLogger.infoPii("Navigate to: "+e),this.popupUtils.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then((function(){var r=e.location.hash;if(u.a.clearHash(e),t.popupUtils.cleanPopup(e),!r)throw c.a.createEmptyHashError(e.location.href);if(i.a.hashContainsKnownProperties(r))return r;throw c.a.createHashDoesNotContainKnownPropertiesError()}))},t}(a.a)},3365:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(3278),o=r(3279),i=r(3283),a=r(3282),c=r(3321),s=r(3277),u=r(3286),d=r(3366),l=function(e){function t(t,r,n,o,i,a,c,s){var u=e.call(this,t,r,n,o,i,a,s)||this;return u.apiId=c,u}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,c,d,l,h;return Object(n.d)(this,(function(p){switch(p.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),o.a.isEmpty(e.loginHint)&&o.a.isEmpty(e.sid)&&(!e.account||o.a.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==i.w.NONE)throw s.a.createSilentPromptValueError(e.prompt);t=this.initializeAuthorizationRequest(Object(n.a)(Object(n.a)({},e),{prompt:i.w.NONE}),u.j.Silent),r=this.initializeServerTelemetryManager(this.apiId),p.label=1;case 1:return p.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return c=p.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return d=p.sent(),this.logger.verbose("Auth code client created"),[4,d.getAuthCodeUrl(t)];case 4:return l=p.sent(),[4,this.silentTokenHelper(l,c,d,this.logger)];case 5:return[2,p.sent()];case 6:throw(h=p.sent())instanceof a.a&&h.setCorrelationId(this.correlationId),r.cacheFailedRequest(h),this.browserStorage.cleanRequestByState(t.state),h;case 7:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(s.a.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t,r,o){return Object(n.b)(this,void 0,void 0,(function(){var i,a,c,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,(i=new d.a(r,this.browserStorage,t,o,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return a=n.sent(),[4,i.monitorIframeForHash(a,this.config.system.iframeHashTimeout)];case 2:return c=n.sent(),s=this.validateAndExtractStateFromHash(c,u.j.Silent,t.correlationId),[2,i.handleCodeResponseFromHash(c,s,r.authority,this.networkClient)]}}))}))},t}(c.a)},3366:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(3278),o=r(3279),i=r(3283),a=r(3309),c=r(3361),s=r(3286),u=r(3277),d=r(3339),l=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r,n,o)||this;return a.navigateFrameWait=i,a}return Object(n.c)(t,e),t.prototype.initiateAuthRequest=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t;return Object(n.d)(this,(function(r){switch(r.label){case 0:if(o.a.isEmpty(e))throw this.browserRequestLogger.info("Navigate url is empty"),u.a.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(n,c){t<d.a&&r.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+d.a+"ms). This may result in timeouts.");var l=window.performance.now()+t,h=setInterval((function(){if(window.performance.now()>l)return r.removeHiddenIframe(e),clearInterval(h),void c(u.a.createMonitorIframeTimeoutError());var t=i.n.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:i.n.EMPTY_STRING}catch(p){}if(!o.a.isEmpty(t)){var d=s?s.location.hash:i.n.EMPTY_STRING;return a.a.hashContainsKnownProperties(d)?(r.removeHiddenIframe(e),clearInterval(h),void n(d)):void 0}}),s.c.POLL_INTERVAL_MS)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(c.a)},3367:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(3278),o=r(3282),i=r(3321),a=r(3277),c=r(3286),s=r(3366),u=r(3368),d=function(e){function t(t,r,n,o,i,a,c,s){var u=e.call(this,t,r,n,o,i,a,s)||this;return u.apiId=c,u}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,i,d,l,h;return Object(n.d)(this,(function(p){switch(p.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw a.a.createAuthCodeRequiredError();t=this.initializeAuthorizationRequest(e,c.j.Silent),r=this.initializeServerTelemetryManager(this.apiId),p.label=1;case 1:return p.trys.push([1,3,,4]),i=Object(n.a)(Object(n.a)({},t),{code:e.code}),[4,this.getClientConfiguration(r,t.authority)];case 2:return d=p.sent(),l=new u.a(d),this.logger.verbose("Auth code client created"),[2,new s.a(l,this.browserStorage,i,this.logger,this.config.system.navigateFrameWait).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,l.authority,this.networkClient,!1)];case 3:throw(h=p.sent())instanceof o.a&&h.setCorrelationId(this.correlationId),r.cacheFailedRequest(h),this.browserStorage.cleanRequestByState(t.state),h;case 4:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(a.a.createSilentLogoutUnsupportedError())},t}(i.a)},3368:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3278),o=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return Object(n.c)(t,e),t}(r(3325).a)},3369:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3278),o=r(3321),i=r(3282),a=r(3290),c=r(3286),s=r(3277),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.acquireToken=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o,a=this;return Object(n.d)(this,(function(s){switch(s.label){case 0:return t=Object(n.a)(Object(n.a)({},e),this.initializeBaseRequest(e)),r=this.initializeServerTelemetryManager(c.a.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(r,t.authority)];case 1:return o=s.sent(),this.logger.verbose("Refresh token client created"),[2,o.acquireTokenByRefreshToken(t).catch((function(e){throw e instanceof i.a&&e.setCorrelationId(a.correlationId),r.cacheFailedRequest(e),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(s.a.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t){return Object(n.b)(this,void 0,void 0,(function(){var r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new a.a(r)]}}))}))},t}(o.a)},3374:function(e,t,r){"use strict";var n=r(3375);function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(i){throw new o("Invalid token specified: "+i.message)}},e.exports.InvalidTokenError=o},3375:function(e,t,r){var n=r(3376);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(r){return n(t)}}},3376:function(e,t){function r(e){this.message=e}r.prototype=new Error,r.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,i=0,a=0,c="";o=t.charAt(a++);~o&&(n=i%4?64*n+o:o,i++%4)?c+=String.fromCharCode(255&n>>(-2*i&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return c}},3401:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2556),o=r(3402),i=r(3410),a=Object(n.a)(o.a,i.a,void 0,{scope:"Dialog"});a.displayName="Dialog"},3402:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(2419),o=r(1887),i=r(2494),a=r(2417),c=r(3403),s=r(2609),u=r(2613),d=r(3404),l=Object(i.a)(),h={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1,enableAriaHiddenSiblings:!0},p={type:c.a.normal,className:"",topButtonsProps:[]},f=function(e){function t(t){var r=e.call(this,t)||this;return r._getSubTextId=function(){var e=r.props,t=e.ariaDescribedById,n=e.modalProps,o=e.dialogContentProps,i=e.subText,a=n&&n.subtitleAriaId||t;return a||(a=(o&&o.subText||i)&&r._defaultSubTextId),a},r._getTitleTextId=function(){var e=r.props,t=e.ariaLabelledById,n=e.modalProps,o=e.dialogContentProps,i=e.title,a=n&&n.titleAriaId||t;return a||(a=(o&&o.title||i)&&r._defaultTitleTextId),a},r._id=Object(a.a)("Dialog"),r._defaultTitleTextId=r._id+"-title",r._defaultSubTextId=r._id+"-subText",r}return Object(n.d)(t,e),t.prototype.render=function(){var e,t,r,i,a,c=this.props,u=c.className,f=c.containerClassName,g=c.contentClassName,m=c.elementToFocusOnDismiss,y=c.firstFocusableSelector,v=c.forceFocusInsideTrap,E=c.styles,b=c.hidden,C=c.disableRestoreFocus,w=void 0===C?c.ignoreExternalFocusing:C,T=c.isBlocking,I=c.isClickableOutsideFocusTrap,S=c.isDarkOverlay,A=c.isOpen,O=void 0===A?!b:A,_=c.onDismiss,R=c.onDismissed,k=c.onLayerDidMount,N=c.responsiveMode,P=c.subText,U=c.theme,j=c.title,D=c.topButtonsProps,M=c.type,L=c.minWidth,x=c.maxWidth,q=c.modalProps,H=Object(n.a)({onLayerDidMount:k},null==q?void 0:q.layerProps);(null==q?void 0:q.dragOptions)&&!(null===(e=q.dragOptions)||void 0===e?void 0:e.dragHandleSelector)&&(i="ms-Dialog-draggable-header",(a=Object(n.a)({},q.dragOptions)).dragHandleSelector="."+i);var F=Object(n.a)(Object(n.a)(Object(n.a)(Object(n.a)({},h),{elementToFocusOnDismiss:m,firstFocusableSelector:y,forceFocusInsideTrap:v,disableRestoreFocus:w,isClickableOutsideFocusTrap:I,responsiveMode:N,className:u,containerClassName:f,isBlocking:T,isDarkOverlay:S,onDismissed:R}),q),{dragOptions:a,layerProps:H,isOpen:O}),K=Object(n.a)(Object(n.a)(Object(n.a)({className:g,subText:P,title:j,topButtonsProps:D,type:M},p),c.dialogContentProps),{draggableHeaderClassName:i,titleProps:Object(n.a)({id:(null===(t=c.dialogContentProps)||void 0===t?void 0:t.titleId)||this._defaultTitleTextId},null===(r=c.dialogContentProps)||void 0===r?void 0:r.titleProps)}),B=l(E,{theme:U,className:F.className,containerClassName:F.containerClassName,hidden:b,dialogDefaultMinWidth:L,dialogDefaultMaxWidth:x});return o.createElement(s.a,Object(n.a)({},F,{className:B.root,containerClassName:B.main,onDismiss:_||F.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),o.createElement(d.a,Object(n.a)({subTextId:this._defaultSubTextId,showCloseButton:F.isBlocking,onDismiss:_},K),c.children))},t.defaultProps={hidden:!0},t=Object(n.c)([u.f],t)}(o.Component)},3403:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(n||(n={}))},3404:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2556),o=r(3405),i=r(3409),a=Object(n.a)(o.a,i.a,void 0,{scope:"DialogContent"})},3405:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(2419),o=r(1887),i=r(2494),a=r(2666),c=r(2767),s=r(2640),u=r(3403),d=r(2672),l=r(3406),h=r(2613);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var f=Object(i.a)(),g=o.createElement(l.a,null).type,m=function(e){function t(t){var r=e.call(this,t)||this;return Object(a.a)(r),Object(c.a)("DialogContent",t,{titleId:"titleProps.id"}),r}return Object(n.d)(t,e),t.prototype.render=function(){var e,t=this.props,r=t.showCloseButton,i=t.className,a=t.closeButtonAriaLabel,c=t.onDismiss,l=t.subTextId,h=t.subText,p=t.titleProps,g=void 0===p?{}:p,m=t.titleId,y=t.title,v=t.type,E=t.styles,b=t.theme,C=t.draggableHeaderClassName,w=f(E,{theme:b,className:i,isLargeHeader:v===u.a.largeHeader,isClose:v===u.a.close,draggableHeaderClassName:C}),T=this._groupChildren();return h&&(e=o.createElement("p",{className:w.subText,id:l},h)),o.createElement("div",{className:w.content},o.createElement("div",{className:w.header},o.createElement("div",Object(n.a)({id:m,role:"heading","aria-level":1},g,{className:Object(s.a)(w.title,g.className)}),y),o.createElement("div",{className:w.topButton},this.props.topButtonsProps.map((function(e,t){return o.createElement(d.a,Object(n.a)({key:e.uniqueId||t},e))})),(v===u.a.close||r&&v!==u.a.largeHeader)&&o.createElement(d.a,{className:w.button,iconProps:{iconName:"Cancel"},ariaLabel:a,onClick:c}))),o.createElement("div",{className:w.inner},o.createElement("div",{className:w.innerContent},e,T.contents),T.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return o.Children.map(this.props.children,(function(t){"object"===p(t)&&null!==t&&t.type===g?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=Object(n.c)([h.f],t)}(o.Component)},3406:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2556),o=r(3407),i=r(3408),a=Object(n.a)(o.a,i.a,void 0,{scope:"DialogFooter"})},3407:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2419),o=r(1887),i=r(2494),a=r(2666),c=Object(i.a)(),s=function(e){function t(t){var r=e.call(this,t)||this;return Object(a.a)(r),r}return Object(n.d)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,r=e.styles,n=e.theme;return this._classNames=c(r,{theme:n,className:t}),o.createElement("div",{className:this._classNames.actions},o.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return o.Children.map(this.props.children,(function(t){return t?o.createElement("span",{className:e._classNames.action},t):null}))},t}(o.Component)},3408:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2505),o={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},i=function(e){var t=e.className,r=e.theme,i=Object(n.R)(o,r);return{actions:[i.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[i.action,{margin:"0 4px"}],actionsRight:[i.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}},3409:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2505),o={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},i=function(e){var t,r,i,a=e.className,c=e.theme,s=e.isLargeHeader,u=e.isClose,d=e.hidden,l=e.isMultiline,h=e.draggableHeaderClassName,p=c.palette,f=c.fonts,g=c.effects,m=c.semanticColors,y=Object(n.R)(o,c);return{content:[s&&[y.contentLgHeader,{borderTop:"4px solid "+p.themePrimary}],u&&y.close,{flexGrow:1,overflowY:"hidden"},a],subText:[y.subText,f.medium,{margin:"0 0 24px 0",color:m.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:n.k.regular}],header:[y.header,{position:"relative",width:"100%",boxSizing:"border-box"},u&&y.close,h&&[h,{cursor:"move"}]],button:[y.button,d&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:m.buttonText,fontSize:n.o.medium}}}],inner:[y.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+n.y+"px) and (max-width: "+n.t+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[y.content,{position:"relative",width:"100%"}],title:[y.title,f.xLarge,{color:m.bodyText,margin:"0",minHeight:f.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(r={},r["@media (min-width: "+n.y+"px) and (max-width: "+n.t+"px)"]={padding:"16px 46px 16px 16px"},r)},s&&{color:m.menuHeader},l&&{fontSize:f.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(i={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:m.buttonText},".ms-Dialog-button:hover":{color:m.buttonTextHovered,borderRadius:g.roundedCorner2}},i["@media (min-width: "+n.y+"px) and (max-width: "+n.t+"px)"]={padding:"15px 8px 0 0"},i)}]}}},3410:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2505),o={root:"ms-Dialog"},i=function(e){var t,r=e.className,i=e.containerClassName,a=e.dialogDefaultMinWidth,c=void 0===a?"288px":a,s=e.dialogDefaultMaxWidth,u=void 0===s?"340px":s,d=e.hidden,l=e.theme;return{root:[Object(n.R)(o,l).root,l.fonts.medium,r],main:[{width:c,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+n.x+"px)"]={width:"auto",maxWidth:u,minWidth:c},t)},!d&&{display:"flex"},i]}}}}]);